/**
 * ============================================================================
 *  NIJJARA ERP - FULL SHEET SETUP SCRIPT
 *  This script creates all system, HR, project, and finance sheets with headers
 *  and seeds base SYS data.
 * ============================================================================
 */

const SYSTEM_USER = "SYSTEM";
const TARGET_SPREADSHEET_ID = "1Oj7So4c5vBDpvj0pIfDeXz6XxBrY011J4xZwKlSkDzo";
const TARGET_SPREADSHEET_URL =
  "https://docs.google.com/spreadsheets/d/1Oj7So4c5vBDpvj0pIfDeXz6XxBrY011J4xZwKlSkDzo/edit";

function getTargetSpreadsheet() {
  try {
    const active = SpreadsheetApp.getActiveSpreadsheet();
    if (active) {
      const activeId = typeof active.getId === "function" ? active.getId() : "";
      if (!TARGET_SPREADSHEET_ID || activeId === TARGET_SPREADSHEET_ID) {
        return active;
      }
    }
  } catch (err) {
    Logger.log(`getTargetSpreadsheet active lookup failed: ${err}`);
  }

  if (TARGET_SPREADSHEET_ID) {
    return SpreadsheetApp.openById(TARGET_SPREADSHEET_ID);
  }

  throw new Error(
    "Unable to resolve target spreadsheet. Set TARGET_SPREADSHEET_ID to the deployment workbook ID."
  );
}

function ensureISODate(date) {
  if (!(date instanceof Date)) return new Date().toISOString().split("T")[0];
  return date.toISOString().split("T")[0];
}

function appendRowsIfEmpty(sheet, rows) {
  if (sheet.getLastRow() <= 1)
    sheet.getRange(2, 1, rows.length, rows[0].length).setValues(rows);
}

function appendRowsIfMissing(sheet, rows, keyIndexes) {
  if (!sheet || !Array.isArray(rows) || !rows.length) {
    return;
  }

  const keys = Array.isArray(keyIndexes) && keyIndexes.length ? keyIndexes : null;
  if (!keys) {
    appendRowsIfEmpty(sheet, rows);
    return;
  }

  const lastRow = sheet.getLastRow();
  if (lastRow <= 1) {
    appendRowsIfEmpty(sheet, rows);
    return;
  }

  const width = Math.max(sheet.getLastColumn(), rows[0].length);
  const existingData = sheet.getRange(2, 1, lastRow - 1, width).getValues();
  const existingKeys = new Set();

  existingData.forEach((row) => {
    const signature = keys
      .map((index) => String(row[index] ?? ""))
      .join("||");
    if (signature) {
      existingKeys.add(signature);
    }
  });

  const newRows = [];
  rows.forEach((row) => {
    const signature = keys
      .map((index) => String(row[index] ?? ""))
      .join("||");
    if (!signature) return;
    if (!existingKeys.has(signature)) {
      newRows.push(row);
      existingKeys.add(signature);
    }
  });

  if (!newRows.length) {
    return;
  }

  sheet
    .getRange(lastRow + 1, 1, newRows.length, rows[0].length)
    .setValues(newRows);
}

function createOrClearSheet(ss, name, headers) {
  let sh = ss.getSheetByName(name);
  if (!sh) sh = ss.insertSheet(name);
  else sh.clear();

  sh.getRange(1, 1, 1, headers.length).setValues([headers]);
  sh.getRange(1, 1, 1, headers.length)
    .setFontWeight("bold")
    .setBackground("#E0E0E0");
  return sh;
}

function ensureSheetsAvailable(ss, sheetNames, contextLabel) {
  const missing = sheetNames.filter((name) => !ss.getSheetByName(name));
  if (missing.length) {
    Logger.log(
      `⚠️ ${contextLabel} seeding skipped; missing sheet(s): ${missing.join(
        ", "
      )}`
    );
    return false;
  }
  return true;
}

function columnToLetter(columnNumber) {
  let column = Number(columnNumber) || 0;
  if (column <= 0) return "A";
  let letter = "";
  while (column > 0) {
    const remainder = ((column - 1) % 26) + 65;
    letter = String.fromCharCode(remainder) + letter;
    column = Math.floor((column - 1) / 26);
  }
  return letter;
}

function applyFormulaToViewSheet(sheet, formula) {
  if (!sheet) return;
  const maxRows = sheet.getMaxRows();
  if (maxRows > 1) {
    sheet.getRange(2, 1, maxRows - 1, sheet.getMaxColumns()).clearContent();
  }
  sheet.getRange(2, 1).setFormula(formula);
}

/** ---------- SCHEMA ---------- **/
function getSheetSchemas() {
  const schemas = {
    // ================== SYSTEM ==================
    SYS_Settings: [
      "Setting_Key",
      "Setting_Value",
      "Description_EN",
      "Updated_By",
      "Updated_At",
      "Created_At",
    ],
    SYS_Audit_Report: [
      "Audit_Id",
      "Entity",
      "Entity_Id",
      "Action",
      "Actor_Id",
      "Summary",
      "Details",
      "Scope",
      "Created_At",
    ],
    SYS_Documents: [
      "Doc_ID",
      "Entity",
      "Entity_ID",
      "File_Name",
      "Label",
      "Drive_File_ID",
      "Drive_URL",
      "Uploaded_By",
      "Created_At",
    ],
    SYS_Profile_View: [
      "View_ID",
      "Tab_ID",
      "Tab_Name",
      "Section_Header",
      "Mode",
      "Source_Sheet",
      "Where_Column",
      "Field_Column",
      "Field_Label",
      "Format",
      "Sort",
      "Role_ID",
    ],
    SYS_Tab_Register: [
      "Record_Type",
      "Tab_ID",
      "Tab_Label_EN",
      "Tab_Label_AR",
      "Sub_ID",
      "Sub_Label_EN",
      "Sub_Label_AR",
      "Route",
      "Sort_Order",
      "Source_Sheet",
      "Permissions",
    ],
    SYS_Dropdowns: [
      "Key",
      "English_Title",
      "Arabic_Title",
      "Is_Active",
      "Sort_Order",
    ],
    SYS_Dynamic_Forms: [
      "Form_ID",
      "Form_Title",
      "Tab_ID",
      "Tab_Name",
      "Section_Header",
      "Field_ID",
      "Field_Label",
      "Field_Type",
      "Source_Sheet",
      "Source_Range",
      "Mandatory",
      "Default_Value",
      "Dropdown_Key",
      "Target_Sheet",
      "Target_Column",
      "Role_ID",
    ],
    SYS_Users: [
      "User_Id",
      "Full_Name",
      "Username",
      "Email",
      "Job_Title",
      "Department",
      "Role_Id",
      "IsActive",
      "Disabled_At",
      "Disabled_By",
      "Password_Hash",
      "Last_Login",
      "Created_At",
      "Created_By",
      "Updated_At",
      "Updated_By",
      "External_Id",
      "MFA_Enabled",
      "Notes",
    ],
    SYS_Roles: [
      "Role_Id",
      "Role_Title",
      "Description",
      "Is_System",
      "Created_At",
      "Created_By",
      "Updated_At",
      "Updated_By",
    ],
    SYS_Permissions: [
      "Permission_Key",
      "Permission_Label",
      "Description",
      "Category",
      "Created_At",
      "Created_By",
      "Updated_At",
      "Updated_By",
    ],
    SYS_Role_Permissions: [
      "Role_Id",
      "Permission_Key",
      "Scope",
      "Allowed",
      "Constraints",
      "Created_At",
      "Created_By",
      "Updated_At",
      "Updated_By",
    ],
    SYS_Audit_Log: [
      "Timestamp",
      "User",
      "Action",
      "Details",
      "Entity",
      "Entity_Id",
      "Scope",
      "Sheet",
      "Target_Id",
      "Actor_Id",
    ],
    SYS_Sessions: [
      "Session_Id",
      "User_Id",
      "Actor_Email",
      "Actor_User_Id",
      "Type",
      "Status",
      "Device",
      "Ip_Address",
      "Auth_Token",
      "Started_At",
      "Ended_At",
      "Created_At",
      "Created_By",
      "Last_Seen",
      "Revoked_At",
      "Revoked_By",
      "Metadata",
    ],
    SYS_User_Properties: [
      "User_Id",
      "Property_Key",
      "Property_Value",
      "Created_At",
      "Created_By",
      "Updated_At",
      "Updated_By",
    ],
    PV_SYS_Users_Table: [
      "User_Id",
      "Full_Name",
      "Username",
      "Email",
      "Department",
      "Role_Id",
      "IsActive",
      "Job_Title",
      "Last_Login",
      "Updated_At",
    ],
    SYS_PubHolidays: ["Pub_Holiday_Date", "Pub_Holiday_Name"],

    // ================== HR MODULE ==================
    HR_Departments: [
      "Dept_Code",
      "Dept_Name_EN",
      "Dept_Name_AR",
      "Is_Active",
      "Sort_Order",
      "Created_At",
      "Created_By",
    ],
    HR_Employees: [
      "Employee_ID",
      "Full_Name_EN",
      "Full_Name_AR",
      "Date_of_Birth",
      "Gender",
      "National_ID",
      "Marital_Status",
      "Military_Status",
      "Mobile_Main",
      "Mobile_Sub",
      "Home_Address",
      "Email",
      "Emergency_Contact",
      "Relation",
      "EC_Mobile",
      "Job_Title",
      "Department",
      "Hire_Date",
      "Contract_Type",
      "Status",
      "Basic_Salary",
      "Allowances",
      "Deductions",
      "Created_At",
      "Created_By",
    ],
    HR_Attendance: [
      "Attendance_ID",
      "Employee_ID",
      "Date",
      "Check_In",
      "Check_Out",
      "Hours",
      "OT_Minutes",
      "OT_Amount",
      "Late_Minutes",
      "EarlyLeave_Minutes",
      "Overtime_Minutes",
      "Notes",
      "Status",
      "Created_At",
      "Created_By",
    ],
    HR_Leave_Requests: [
      "Leave_ID",
      "Employee_ID",
      "Leave_Type",
      "Start_Date",
      "End_Date",
      "Days_Count",
      "Days",
      "Approver",
      "Reason",
      "Notes",
      "Status",
      "Created_At",
      "Created_By",
    ],
    HR_Absence_Deductions: [
      "Absence_ID",
      "Employee_ID",
      "Absence_Date",
      "Absence_Type",
      "Duration",
      "Deduction_Amount",
      "Reason",
      "Status",
      "Entry_Date",
      "Entered_By",
    ],
    HR_Leave: [
      "Leave_ID",
      "Emp_ID",
      "Leave_Type",
      "Start_Date",
      "End_Date",
      "Days_Count",
      "Status",
      "Notes",
    ],
    HR_Leave_Analysis: [
      "Employee_ID",
      "Full_Name",
      "Annual_Leave_Count",
      "Sick_Leave_Count",
      "Emergency_Leave_Count",
      "Total_Leave_Days",
      "_",
    ],
    HR_Advances: [
      "Advance_ID",
      "Employee_ID",
      "Issue_Date",
      "Amount",
      "Settlement_Period",
      "Advance_Installment",
      "Notes",
      "Status",
      "Created_At",
    ],
    HR_OverTime: [
      "OverTime_ID",
      "Employee_ID",
      "Date",
      "OT_WorkDay",
      "OT_WorkDay_Amount",
      "OT_WeekEnd",
      "OT_WeekEnd_Amount",
      "OT_Public_Holiday",
      "OT_Public_Holiday_Amount",
      "Total_OT_Amount",
      "Created_At",
    ],
    HR_Penalties: [
      "Penalty_ID",
      "Penalty_Name",
      "Penalty_Rule",
      "Notes",
      "Created_At",
    ],
    HR_Deductions: [
      "Deduction_ID",
      "Penalty_ID",
      "Employee_ID",
      "Date",
      "Deduction_Amount",
      "Created_At",
    ],
    HR_Payroll: [
      "Payroll_ID",
      "Employee_ID",
      "Start_Date",
      "End_Date",
      "Basic_Salary",
      "Total_OT_Amount",
      "Advance_Installment",
      "Deduction_Amount",
      "Net_Pay",
      "Status",
      "Created_At",
    ],
    HR_KPIs: ["Metric", "Value", "Notes"],

    // ================== PROJECTS ==================
    PRJ_Main: [
      "Project_ID",
      "Project_Name",
      "Client_ID",
      "Client_Name",
      "Contract_ID",
      "Start_Date",
      "Planned_Days",
      "Planned_End_Date",
      "End_Date",
      "Status",
      "Project_Type",
      "Project_Priority",
      "Notes",
      "Proj_Budget",
      "Budget",
      "Total_Pay_Received",
      "Total_Pay_Pending",
      "Planned_Material_Expense",
      "Actual_Material_Expense",
      "Planned_Materials",
      "Actual_Materials",
      "Manager",
      "Created_At",
      "Created_By",
    ],
    PRJ_Tasks: [
      "Task_ID",
      "Project_ID",
      "Task_Name",
      "Task_Priority",
      "Assignee_ID",
      "Planned_Start",
      "Planned_End",
      "Actual_Start",
      "Actual_End",
      "Status",
      "Created_At",
      "Created_By",
    ],
    PRJ_Costs: [
      "Cost_ID",
      "Project_ID",
      "Date",
      "Category",
      "Description",
      "Amount",
      "Created_At",
      "Created_By",
    ],
    PRJ_Clients: [
      "Client_ID",
      "Client_Name",
      "Client_Mobile_1",
      "Client_Mobile_2",
      "Client_Email",
      "Created_At",
    ],
    PRJ_Materials: [
      "Material_ID",
      "Name_AR",
      "Name_EN",
      "Category",
      "Subcategory",
      "Sub2",
      "Default_Unit",
      "Default_Price",
      "VAT_Rate",
      "Active",
      "Updated_At",
      "Updated_By",
    ],
    PV_PRJ_Materials: [
      "Material_ID",
      "Name_AR",
      "Name_EN",
      "Category",
      "Subcategory",
      "Default_Unit",
      "Default_Price",
      "VAT_Rate",
      "Active",
      "Updated_At",
      "Updated_By",
    ],
    PV_PRJ_Main: [
      "معرّف المشروع",
      "اسم المشروع",
      "العميل",
      "تاريخ البدء",
      "الأيام المخططة",
      "تاريخ الانتهاء المخطط",
      "تاريخ الانتهاء الفعلي",
      "حالة المشروع",
      "نوع المشروع",
      "أولوية المشروع",
      "الميزانية",
      "التكلفة الفعلية",
      "الفرق عن الميزانية",
      "نسبة التقدم",
      "ملاحظات",
      "مدير المشروع",
    ],
    PV_PRJ_Costs: [
      "معرّف المشروع",
      "اسم المشروع",
      "تاريخ التكلفة",
      "فئة التكلفة",
      "الوصف",
      "المبلغ",
      "أنشئ بواسطة",
      "تاريخ الإنشاء",
    ],
    PRJ_InDirExp_Allocations: [
      "Allocation_ID",
      "InDirExpense_Repeated_ID",
      "InDirExpense_Once_ID",
      "Project_ID",
      "Allocation_Method",
      "Allocation_Percentage",
      "Allocation_Amount",
      "Created_At",
    ],
    PRJ_Schedule_Calc: [
      "Project_ID",
      "Project_Name",
      "Start_Date",
      "Planned_Days",
      "Planned_End_Date",
      "Schedule_Flag",
    ],
    PRJ_Dashboard: [
      "Project_ID",
      "Project_Name",
      "Start_Date",
      "Planned_End_Date",
      "Status",
      "Actual_Material_Expense",
      "Total_Ind_Expense",
      "Total_Pay_Received",
      "Proj_Budget",
      "Profit",
      "Schedule_Flag",
      "Cost_Flag",
    ],
    PRJ_KPIs: ["Metric", "Value", "Notes"],

    // ================== FINANCE ==================
    FIN_DirectExpenses: [
      "Expense_ID",
      "Project_ID",
      "Date",
      "Category",
      "Level_1",
      "Level_2",
      "Unit",
      "Qty",
      "Unit_Price",
      "Amount",
      "VAT_Rate",
      "VAT_Amount",
      "Total_With_VAT",
      "Material_ID",
      "Material_Name",
      "Pay_Status",
      "Pay_Method",
      "Notes",
      "Created_At",
      "Created_By",
      "Updated_At",
      "Updated_By",
    ],
    PV_FIN_DirectExpenses_View: [
      "Expense_ID",
      "Expense_Date",
      "Project_ID",
      "Project_Name",
      "Category",
      "Level_1",
      "Level_2",
      "Material_ID",
      "Material_Name",
      "Quantity",
      "Unit",
      "Unit_Price",
      "Amount",
      "VAT_Rate",
      "VAT_Amount",
      "Total_With_VAT",
      "Payment_Status",
      "Payment_Method",
      "Notes",
      "Created_By",
      "Created_At",
      "Updated_By",
      "Updated_At",
    ],
    PV_FIN_InDirExpense_Repeated_View: [
      "Expense_ID",
      "Expense_Name",
      "Category",
      "Frequency",
      "Start_Date",
      "End_Date",
      "Next_Pay_Date",
      "Amount",
      "Paid_By",
      "Payment_Status",
      "Payment_Method",
      "Allocation_Method",
      "Notes",
      "Created_At",
      "Updated_At",
    ],
    PV_FIN_InDirExpense_Once_View: [
      "Expense_ID",
      "Expense_Name",
      "Category",
      "Expense_Date",
      "Amount",
      "Paid_By",
      "Payment_Status",
      "Payment_Method",
      "Allocation_Method",
      "Useful_Life_Months",
      "Depreciation_Start_Date",
      "Notes",
      "Created_At",
      "Updated_At",
    ],
    FIN_InDirExpense_Repeated: [
      "InDirExpense_Repeated_ID",
      "Expense_Name",
      "Category",
      "Frequency",
      "Start_Date",
      "End_Date",
      "Next_Pay_Date",
      "Amount",
      "Paid_By",
      "Pay_Status",
      "Pay_Method",
      "Allocation_Method",
      "Notes",
      "Created_At",
      "Created_By",
      "Updated_At",
    ],
    FIN_InDirExpense_Once: [
      "InDirExpense_Once_ID",
      "Expense_Name",
      "Category",
      "Expense_Date",
      "Amount",
      "Paid_By",
      "Pay_Status",
      "Pay_Method",
      "Allocation_Method",
      "Useful_Life_Months",
      "Depreciation_Start_Date",
      "Notes",
      "Created_At",
      "Created_By",
      "Updated_At",
    ],
    FIN_Project_Revenue: [
      "Revenue_ID",
      "Project_ID",
      "Revenue_Date",
      "Amount",
      "Revenue_Type",
      "Source",
      "Description",
      "Pay_Method",
      "Invoice_Number",
      "Pay_Status",
      "Created_At",
      "Created_By",
      "Updated_At",
    ],
    PV_FIN_Project_Revenue_View: [
      "Revenue_ID",
      "Project_ID",
      "Project_Name",
      "Revenue_Date",
      "Amount",
      "Revenue_Type",
      "Source",
      "Description",
      "Payment_Method",
      "Invoice_Number",
      "Payment_Status",
      "Created_By",
      "Created_At",
      "Updated_At",
    ],
    FIN_Revenues: [
      "Revenue_ID",
      "Revenue_Type",
      "Revenue_Date",
      "Amount",
      "Source",
      "Description",
      "Pay_Method",
      "Pay_Status",
      "Client_ID",
      "Project_ID",
      "Reference",
      "Notes",
      "Created_At",
      "Created_By",
      "Updated_At",
    ],
    PV_FIN_Revenues_View: [
      "Revenue_ID",
      "Revenue_Date",
      "Revenue_Type",
      "Amount",
      "Source",
      "Description",
      "Payment_Method",
      "Payment_Status",
      "Client_ID",
      "Client_Name",
      "Project_ID",
      "Project_Name",
      "Reference",
      "Notes",
      "Created_By",
      "Created_At",
      "Updated_At",
    ],
    FIN_Journal: [
      "Journal_ID",
      "Journal_Date",
      "Account",
      "Counterparty_Account",
      "Debit_Amount",
      "Credit_Amount",
      "Project_ID",
      "Description",
      "Reference",
      "Created_At",
      "Created_By",
      "Updated_At",
    ],
    PV_FIN_Journal_View: [
      "Journal_ID",
      "Journal_Date",
      "Account",
      "Counterparty_Account",
      "Debit_Amount",
      "Credit_Amount",
      "Project_ID",
      "Description",
      "Reference",
      "Created_By",
      "Created_At",
      "Updated_At",
    ],
    FIN_Custody: [
      "Custody_ID",
      "Employee_ID",
      "Employee_Name",
      "Issue_Date",
      "Return_Due_Date",
      "Amount",
      "Purpose",
      "Status",
      "Notes",
      "Created_At",
      "Created_By",
      "Updated_At",
    ],
    PV_FIN_Custody_View: [
      "Custody_ID",
      "Employee_ID",
      "Employee_Name",
      "Issue_Date",
      "Return_Due_Date",
      "Amount",
      "Purpose",
      "Status",
      "Notes",
      "Created_By",
      "Created_At",
      "Updated_At",
    ],
    FIN_GL_Totals: [
      "Account",
      "Debit_Total",
      "Credit_Total",
      "Balance",
      "Last_Updated",
    ],
    PV_FIN_GL_Totals_View: [
      "Account",
      "Debit_Total",
      "Credit_Total",
      "Balance",
      "Last_Updated",
    ],
    FIN_KPIs: ["Metric", "Value", "Notes"],
  };
  schemas.PV_PRJ_Main = Array.isArray(schemas.PRJ_Main) ? schemas.PRJ_Main.slice() : [];
  schemas.PV_PRJ_Tasks = Array.isArray(schemas.PRJ_Tasks) ? schemas.PRJ_Tasks.slice() : [];
  schemas.PV_PRJ_Costs = Array.isArray(schemas.PRJ_Costs) ? schemas.PRJ_Costs.slice() : [];
  schemas.PV_PRJ_Clients = Array.isArray(schemas.PRJ_Clients) ? schemas.PRJ_Clients.slice() : [];
  schemas.PV_PRJ_Schedule_Calc = Array.isArray(schemas.PRJ_Schedule_Calc) ? schemas.PRJ_Schedule_Calc.slice() : [];
  schemas.PV_PRJ_Dashboard = Array.isArray(schemas.PRJ_Dashboard) ? schemas.PRJ_Dashboard.slice() : [];
  schemas.PV_PRJ_KPIs = Array.isArray(schemas.PRJ_KPIs) ? schemas.PRJ_KPIs.slice() : [];
  schemas.PV_PRJ_InDirExp_Allocations = Array.isArray(schemas.PRJ_InDirExp_Allocations) ? schemas.PRJ_InDirExp_Allocations.slice() : [];
  schemas.PV_FIN_Project_Revenue = Array.isArray(schemas.FIN_PROJECT_REVENUE) ? schemas.FIN_PROJECT_REVENUE.slice() : [];
  schemas.PV_FIN_Revenues = Array.isArray(schemas.FIN_REVENUES) ? schemas.FIN_REVENUES.slice() : [];
  schemas.PV_FIN_Journal = Array.isArray(schemas.FIN_JOURNAL) ? schemas.FIN_JOURNAL.slice() : [];
  schemas.PV_FIN_Custody = Array.isArray(schemas.FIN_CUSTODY) ? schemas.FIN_CUSTODY.slice() : [];
  schemas.PV_FIN_GL_Totals = Array.isArray(schemas.FIN_GL_Totals) ? schemas.FIN_GL_Totals.slice() : [];
  schemas.PV_FIN_KPIs = Array.isArray(schemas.FIN_KPIs) ? schemas.FIN_KPIs.slice() : [];
  schemas.PV_FIN_InDirExpense_Once = Array.isArray(schemas.FIN_InDirExpense_Once) ? schemas.FIN_InDirExpense_Once.slice() : [];
  schemas.PV_FIN_InDirExpense_Repeated = Array.isArray(schemas.FIN_InDirExpense_Repeated) ? schemas.FIN_InDirExpense_Repeated.slice() : [];
  schemas.PV_HR_Employees = Array.isArray(schemas.HR_EMPLOYEES) ? schemas.HR_EMPLOYEES.slice() : [];
  schemas.PV_HR_Departments = Array.isArray(schemas.HR_DEPARTMENTS) ? schemas.HR_DEPARTMENTS.slice() : [];
  schemas.PV_HR_Attendance = Array.isArray(schemas.HR_ATTENDANCE) ? schemas.HR_ATTENDANCE.slice() : [];
  schemas.PV_HR_Leave = Array.isArray(schemas.HR_LEAVE) ? schemas.HR_LEAVE.slice() : [];
  schemas.PV_HR_Leave_Requests = Array.isArray(schemas.HR_LEAVE_REQUESTS) ? schemas.HR_LEAVE_REQUESTS.slice() : [];
  schemas.PV_HR_Advances = Array.isArray(schemas.HR_ADVANCES) ? schemas.HR_ADVANCES.slice() : [];
  schemas.PV_HR_Deductions = Array.isArray(schemas.HR_DEDUCTIONS) ? schemas.HR_DEDUCTIONS.slice() : [];
  schemas.PV_HR_Payroll = Array.isArray(schemas.HR_PAYROLL) ? schemas.HR_PAYROLL.slice() : [];

  return schemas;
}

/** ---------- SEED DATA ---------- **/
function seedSysSettings(ss) {
  const sh = ss.getSheetByName("SYS_Settings");
  const now = new Date();
  const rows = [
    ["APP_NAME", "Nijjara_ERP", "Application name", SYSTEM_USER, now, now],
    ["DEFAULT_CURRENCY", "EGP", "Default currency", SYSTEM_USER, now, now],
    [
      "BOOTSTRAP_TIMESTAMP",
      now.toISOString(),
      "Boot timestamp",
      SYSTEM_USER,
      now,
      now,
    ],
  ];
  appendRowsIfEmpty(sh, rows);
}

function seedSysTabRegister(ss) {
  const sh = ss.getSheetByName("SYS_Tab_Register");
  const rows = [
    [
      "TAB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "",
      "",
      "",
      "",
      1,
      "",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Overview",
      "Overview",
      "نظرة عامة",
      "/sys",
      1,
      "PV_SYS_Overview",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Users",
      "Users",
      "المستخدمون",
      "/sys/users",
      2,
      "PV_SYS_Users_Table",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Roles",
      "Roles",
      "الأدوار",
      "/sys/roles",
      3,
      "SYS_Roles",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Permissions",
      "Permissions",
      "الأذونات",
      "/sys/permissions",
      4,
      "SYS_Permissions",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_RolePerms",
      "Role Permissions",
      "تعيين أذونات الأدوار",
      "/sys/role-perms",
      5,
      "SYS_Role_Permissions",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Properties",
      "User Properties",
      "خصائص المستخدم",
      "/sys/properties",
      6,
      "SYS_User_Properties",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Sessions",
      "Sessions",
      "الجلسات",
      "/sys/sessions",
      7,
      "SYS_Sessions",
      "SYS_VIEW",
    ],
    [
      "SUB",
      "Tab_SYS_Management",
      "System's Management",
      "إدارة النظام",
      "Sub_SYS_Audit",
      "Audit",
      "التدقيق",
      "/sys/audit",
      8,
      "SYS_Audit_Report",
      "SYS_VIEW",
    ],
    [
      "TAB",
      "Tab_PRJ_Management",
      "Projects",
      "إدارة المشاريع",
      "",
      "",
      "",
      "",
      20,
      "",
      "PRJ_VIEW_PROJECTS",
    ],
    [
      "SUB",
      "Tab_PRJ_Management",
      "Projects",
      "إدارة المشاريع",
      "Sub_PRJ_Main",
      "Projects",
      "قائمة المشاريع",
      "/projects",
      1,
      "PV_PRJ_Main",
      "PRJ_VIEW_PROJECTS",
    ],
    [
      "SUB",
      "Tab_PRJ_Management",
      "Projects",
      "إدارة المشاريع",
      "Sub_PRJ_Tasks",
      "Tasks",
      "المهام",
      "/projects/tasks",
      2,
      "PV_PRJ_Tasks",
      "PRJ_VIEW_PROJECTS",
    ],
    [
      "SUB",
      "Tab_PRJ_Management",
      "Projects",
      "إدارة المشاريع",
      "Sub_PRJ_Costs",
      "Costs",
      "التكاليف",
      "/projects/costs",
      3,
      "PV_PRJ_Costs",
      "PRJ_VIEW_PROJECTS",
    ],
    [
      "SUB",
      "Tab_PRJ_Management",
      "Projects",
      "إدارة المشاريع",
      "Sub_PRJ_Materials",
      "Materials",
      "المواد",
      "/projects/materials",
      4,
      "PV_PRJ_Materials",
      "PRJ_VIEW_PROJECTS",
    ],
    [
      "SUB",
      "Tab_PRJ_Management",
      "Projects",
      "إدارة المشاريع",
      "Sub_PRJ_Revenue",
      "Revenue",
      "الإيرادات",
      "/projects/revenue",
      5,
      "PV_FIN_Project_Revenue_View",
      "PRJ_VIEW_PROJECTS",
    ],
    [
      "TAB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "",
      "",
      "",
      "",
      30,
      "",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_Direct",
      "Direct Expenses",
      "المصاريف المباشرة",
      "/fin/direct",
      1,
      "PV_FIN_DirectExpenses_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_Indirect_Rep",
      "Indirect Expenses (Repeat)",
      "المصاريف غير المباشرة (متكررة)",
      "/fin/indirect-rep",
      2,
      "PV_FIN_InDirExpense_Repeated_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_Indirect_Once",
      "Indirect Expenses (Once)",
      "المصاريف غير المباشرة (مرة واحدة)",
      "/fin/indirect-once",
      3,
      "PV_FIN_InDirExpense_Once_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_PrjRevenue",
      "Project Revenue",
      "إيرادات المشاريع",
      "/fin/prj-revenue",
      4,
      "PV_FIN_Project_Revenue_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_GenRevenue",
      "General Revenues",
      "الإيرادات العامة",
      "/fin/gen-revenue",
      5,
      "PV_FIN_Revenues_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_Journal",
      "Journal",
      "دفتر اليومية",
      "/fin/journal",
      6,
      "PV_FIN_Journal_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_Custody",
      "Custody",
      "العهد",
      "/fin/custody",
      7,
      "PV_FIN_Custody_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_GL",
      "GL Totals",
      "إجمالي الحسابات",
      "/fin/gl",
      8,
      "PV_FIN_GL_Totals_View",
      "FIN_VIEW_REPORTS",
    ],
    [
      "SUB",
      "Tab_FIN_Management",
      "Finance Management",
      "إدارة المالية",
      "Sub_FIN_KPIs",
      "KPIs",
      "المؤشرات الرئيسية",
      "/fin/kpis",
      9,
      "PV_FIN_KPIs",
      "FIN_VIEW_REPORTS",
    ],
    [
      "TAB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "",
      "",
      "",
      "",
      40,
      "",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Employees",
      "Employees",
      "الموظفون",
      "/hr/employees",
      1,
      "PV_HR_Employees",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Attendance",
      "Attendance",
      "الحضور",
      "/hr/attendance",
      2,
      "PV_HR_Attendance",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Leave",
      "Leave",
      "الإجازات",
      "/hr/leave",
      3,
      "PV_HR_Leave",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Leave_Requests",
      "Leave Requests",
      "طلبات الإجازة",
      "/hr/leave-requests",
      4,
      "PV_HR_Leave_Requests",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Advances",
      "Advances",
      "السلف",
      "/hr/advances",
      5,
      "PV_HR_Advances",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Deductions",
      "Deductions",
      "الخصومات",
      "/hr/deductions",
      6,
      "PV_HR_Deductions",
      "HR_VIEW_EMPLOYEES",
    ],
    [
      "SUB",
      "Tab_HR_Management",
      "HR Management",
      "إدارة الموارد البشرية",
      "Sub_HR_Payroll",
      "Payroll",
      "الرواتب",
      "/hr/payroll",
      7,
      "PV_HR_Payroll",
      "HR_VIEW_EMPLOYEES",
    ],
  ];
  appendRowsIfEmpty(sh, rows);
}

function seedSysProfileView(ss) {
  const sh = ss.getSheetByName("SYS_Profile_View");
  const rows = [
    [
      "PV_SYS_Overview_TotalUsers",
      "Sub_SYS_Overview",
      "Overview",
      "إحصائيات النظام",
      "Number",
      "SYS_Users",
      "",
      "User_Id",
      "إجمالي المستخدمين",
      "Number",
      1,
      "",
    ],
    [
      "PV_SYS_Overview_Active",
      "Sub_SYS_Overview",
      "Overview",
      "إحصائيات النظام",
      "Number",
      "SYS_Users",
      "IsActive",
      "IsActive",
      "المستخدمون النشطون",
      "Number",
      2,
      "",
    ],
    [
      "PV_SYS_Overview_Roles",
      "Sub_SYS_Overview",
      "Overview",
      "إحصائيات النظام",
      "Number",
      "SYS_Roles",
      "",
      "Role_Id",
      "إجمالي الأدوار",
      "Number",
      3,
      "",
    ],
    [
      "PV_SYS_Users_Table",
      "Sub_SYS_Users",
      "Users",
      "قائمة المستخدمين",
      "Table",
      "SYS_Users",
      "",
      "*",
      "قائمة المستخدمين",
      "Table",
      1,
      "",
    ],
    [
      "PV_SYS_User_Documents",
      "Sub_SYS_Users",
      "Users",
      "مستندات المستخدم",
      "Table",
      "SYS_Documents",
      "Entity_ID",
      "*",
      "مستندات",
      "Table",
      2,
      "",
    ],
  ];
  appendRowsIfEmpty(sh, rows);
}

let dynamicFormCache = null;
function getDynamicFormDefinitions() {
  if (dynamicFormCache) {
    return dynamicFormCache;
  }
  dynamicFormCache = [
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "التعريف",
      "USR_User_Id",
      "معرّف المستخدم",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "SYS_Users",
      "User_Id",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "بيانات المستخدم",
      "USR_Full_Name",
      "الاسم الكامل",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "SYS_Users",
      "Full_Name",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "بيانات المستخدم",
      "USR_Username",
      "اسم المستخدم",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "SYS_Users",
      "Username",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "بيانات المستخدم",
      "USR_Email",
      "البريد الإلكتروني",
      "Email",
      "",
      "",
      "Yes",
      "",
      "",
      "SYS_Users",
      "Email",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "العمل",
      "USR_Job_Title",
      "المسمى الوظيفي",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "SYS_Users",
      "Job_Title",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "العمل",
      "USR_Department",
      "القسم",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Departments",
      "SYS_Users",
      "Department",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "العمل",
      "USR_Role",
      "الدور",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Roles",
      "SYS_Users",
      "Role_Id",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "الإعدادات",
      "USR_IsActive",
      "نشط؟",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "TRUE",
      "DD_YesNo",
      "SYS_Users",
      "IsActive",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "الإعدادات",
      "USR_Password",
      "كلمة المرور",
      "Password",
      "",
      "",
      "Yes",
      "",
      "",
      "SYS_Users",
      "password",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "الإعدادات",
      "USR_MFA",
      "تفعيل MFA",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Disabled",
      "DD_MFA_Status",
      "SYS_Users",
      "MFA_Enabled",
      "",
    ],
    [
      "FORM_SYS_AddUser",
      "إضافة مستخدم جديد",
      "Sub_SYS_Users",
      "المستخدمون",
      "الإعدادات",
      "USR_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "SYS_Users",
      "Notes",
      "",
    ],
    [
      "FORM_SYS_EditUser",
      "تعديل مستخدم",
      "Sub_SYS_Users",
      "المستخدمون",
      "بيانات المستخدم",
      "USR_Full_Name",
      "الاسم الكامل",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "SYS_Users",
      "Full_Name",
      "",
    ],
    [
      "FORM_SYS_EditUser",
      "تعديل مستخدم",
      "Sub_SYS_Users",
      "المستخدمون",
      "بيانات المستخدم",
      "USR_Email",
      "البريد الإلكتروني",
      "Email",
      "",
      "",
      "Yes",
      "",
      "",
      "SYS_Users",
      "Email",
      "",
    ],
    [
      "FORM_SYS_EditUser",
      "تعديل مستخدم",
      "Sub_SYS_Users",
      "المستخدمون",
      "العمل",
      "USR_Department",
      "القسم",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Departments",
      "SYS_Users",
      "Department",
      "",
    ],
    [
      "FORM_SYS_EditUser",
      "تعديل مستخدم",
      "Sub_SYS_Users",
      "المستخدمون",
      "العمل",
      "USR_Role",
      "الدور",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Roles",
      "SYS_Users",
      "Role_Id",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "البيانات الأساسية",
      "MAT_Material_ID",
      "معرّف المادة",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "PRJ_Materials",
      "Material_ID",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "البيانات الأساسية",
      "MAT_Name_AR",
      "اسم المادة (عربي)",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "PRJ_Materials",
      "Name_AR",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "البيانات الأساسية",
      "MAT_Name_EN",
      "اسم المادة (إنجليزي)",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "PRJ_Materials",
      "Name_EN",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "التصنيفات",
      "MAT_Category",
      "التصنيف الرئيسي",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "PRJ_Materials",
      "Category",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "التصنيفات",
      "MAT_Subcategory",
      "التصنيف الفرعي",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "PRJ_Materials",
      "Subcategory",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "إعدادات الكمية",
      "MAT_Default_Unit",
      "الوحدة الافتراضية",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "PRJ_Materials",
      "Default_Unit",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "إعدادات الكمية",
      "MAT_Default_Price",
      "السعر الافتراضي",
      "Number",
      "",
      "",
      "Yes",
      "0",
      "",
      "PRJ_Materials",
      "Default_Price",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "إعدادات الكمية",
      "MAT_VAT_Rate",
      "نسبة ضريبة القيمة المضافة",
      "Number",
      "",
      "",
      "No",
      "0.14",
      "",
      "PRJ_Materials",
      "VAT_Rate",
      "",
    ],
    [
      "FORM_PRJ_AddMaterial",
      "إضافة مادة جديدة",
      "Sub_PRJ_Materials",
      "المواد",
      "إعدادات الحالة",
      "MAT_IsActive",
      "نشط؟",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "TRUE",
      "DD_YesNo",
      "PRJ_Materials",
      "Active",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "المعرّف",
      "FIN_Direct_ID",
      "معرّف المصروف",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Expense_ID",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل الأساسية",
      "FIN_Direct_Project",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Projects",
      "FIN_DirectExpenses",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل الأساسية",
      "FIN_Direct_Date",
      "تاريخ المصروف",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_DirectExpenses",
      "Date",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل الأساسية",
      "FIN_Direct_Category",
      "التصنيف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Expense_Category",
      "FIN_DirectExpenses",
      "Category",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل",
      "FIN_Direct_Level1",
      "المستوى 1",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Level_1",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل",
      "FIN_Direct_Level2",
      "المستوى 2",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Level_2",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الكميات",
      "FIN_Direct_Unit",
      "الوحدة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Unit",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الكميات",
      "FIN_Direct_Qty",
      "الكمية",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Qty",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الكميات",
      "FIN_Direct_UnitPrice",
      "سعر الوحدة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Unit_Price",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_DirectExpenses",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_VATRate",
      "نسبة الضريبة",
      "Number",
      "",
      "",
      "No",
      "0",
      "",
      "FIN_DirectExpenses",
      "VAT_Rate",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_VATAmount",
      "قيمة الضريبة",
      "Number",
      "",
      "",
      "No",
      "0",
      "",
      "FIN_DirectExpenses",
      "VAT_Amount",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_TotalVAT",
      "الإجمالي مع الضريبة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Total_With_VAT",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "المواد",
      "FIN_Direct_MaterialID",
      "معرّف المادة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Material_ID",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "المواد",
      "FIN_Direct_MaterialName",
      "اسم المادة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Material_Name",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الدفع",
      "FIN_Direct_PayStatus",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Pending",
      "DD_Payment_Status",
      "FIN_DirectExpenses",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الدفع",
      "FIN_Direct_PayMethod",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_DirectExpenses",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_AddDirectExpense",
      "تسجيل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "ملاحظات",
      "FIN_Direct_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "المعرّف",
      "FIN_Direct_ID_View",
      "معرّف المصروف",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Expense_ID",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل الأساسية",
      "FIN_Direct_Project_Edit",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Projects",
      "FIN_DirectExpenses",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل الأساسية",
      "FIN_Direct_Date_Edit",
      "تاريخ المصروف",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_DirectExpenses",
      "Date",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل الأساسية",
      "FIN_Direct_Category_Edit",
      "التصنيف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Expense_Category",
      "FIN_DirectExpenses",
      "Category",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل",
      "FIN_Direct_Level1_Edit",
      "المستوى 1",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Level_1",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "التفاصيل",
      "FIN_Direct_Level2_Edit",
      "المستوى 2",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Level_2",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الكميات",
      "FIN_Direct_Unit_Edit",
      "الوحدة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Unit",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الكميات",
      "FIN_Direct_Qty_Edit",
      "الكمية",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Qty",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الكميات",
      "FIN_Direct_UnitPrice_Edit",
      "سعر الوحدة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Unit_Price",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_Amount_Edit",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_DirectExpenses",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_VATRate_Edit",
      "نسبة الضريبة",
      "Number",
      "",
      "",
      "No",
      "0",
      "",
      "FIN_DirectExpenses",
      "VAT_Rate",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_VATAmount_Edit",
      "قيمة الضريبة",
      "Number",
      "",
      "",
      "No",
      "0",
      "",
      "FIN_DirectExpenses",
      "VAT_Amount",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "القيم",
      "FIN_Direct_TotalVAT_Edit",
      "الإجمالي مع الضريبة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Total_With_VAT",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "المواد",
      "FIN_Direct_MaterialID_Edit",
      "معرّف المادة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Material_ID",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "المواد",
      "FIN_Direct_MaterialName_Edit",
      "اسم المادة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Material_Name",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الدفع",
      "FIN_Direct_PayStatus_Edit",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Status",
      "FIN_DirectExpenses",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "الدفع",
      "FIN_Direct_PayMethod_Edit",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_DirectExpenses",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_EditDirectExpense",
      "تعديل مصروف مباشر",
      "Sub_FIN_Direct",
      "المصاريف المباشرة",
      "ملاحظات",
      "FIN_Direct_Notes_Edit",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_DirectExpenses",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "المعرّف",
      "FIN_Rep_ID",
      "معرّف المصروف",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "InDirExpense_Repeated_ID",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التفاصيل",
      "FIN_Rep_Name",
      "اسم المصروف",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Expense_Name",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التفاصيل",
      "FIN_Rep_Category",
      "التصنيف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Expense_Category",
      "FIN_InDirExpense_Repeated",
      "Category",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "الدورات",
      "FIN_Rep_Frequency",
      "التكرار",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Monthly",
      "DD_Indirect_Frequency",
      "FIN_InDirExpense_Repeated",
      "Frequency",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التواريخ",
      "FIN_Rep_Start",
      "تاريخ البدء",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Start_Date",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التواريخ",
      "FIN_Rep_End",
      "تاريخ الانتهاء",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "End_Date",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التواريخ",
      "FIN_Rep_NextPay",
      "تاريخ السداد",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Next_Pay_Date",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "القيم",
      "FIN_Rep_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "القيم",
      "FIN_Rep_PaidBy",
      "مدفوع بواسطة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Paid_By",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "الدفع",
      "FIN_Rep_PayStatus",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Pending",
      "DD_Payment_Status",
      "FIN_InDirExpense_Repeated",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "الدفع",
      "FIN_Rep_PayMethod",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_InDirExpense_Repeated",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التوزيع",
      "FIN_Rep_Allocation",
      "أساس التوزيع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Allocation_Method",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseRep",
      "إضافة مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "ملاحظات",
      "FIN_Rep_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "المعرّف",
      "FIN_Rep_ID_View",
      "معرّف المصروف",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "InDirExpense_Repeated_ID",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التفاصيل",
      "FIN_Rep_Name_Edit",
      "اسم المصروف",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Expense_Name",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التفاصيل",
      "FIN_Rep_Category_Edit",
      "التصنيف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Expense_Category",
      "FIN_InDirExpense_Repeated",
      "Category",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "الدورات",
      "FIN_Rep_Frequency_Edit",
      "التكرار",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Indirect_Frequency",
      "FIN_InDirExpense_Repeated",
      "Frequency",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التواريخ",
      "FIN_Rep_Start_Edit",
      "تاريخ البدء",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Start_Date",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التواريخ",
      "FIN_Rep_End_Edit",
      "تاريخ الانتهاء",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "End_Date",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التواريخ",
      "FIN_Rep_NextPay_Edit",
      "تاريخ السداد",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Next_Pay_Date",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "القيم",
      "FIN_Rep_Amount_Edit",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "القيم",
      "FIN_Rep_PaidBy_Edit",
      "مدفوع بواسطة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Paid_By",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "الدفع",
      "FIN_Rep_PayStatus_Edit",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Status",
      "FIN_InDirExpense_Repeated",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "الدفع",
      "FIN_Rep_PayMethod_Edit",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_InDirExpense_Repeated",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "التوزيع",
      "FIN_Rep_Allocation_Edit",
      "أساس التوزيع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Allocation_Method",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseRep",
      "تعديل مصروف غير مباشر (متكرر)",
      "Sub_FIN_Indirect_Rep",
      "المصاريف غير المباشرة (متكررة)",
      "ملاحظات",
      "FIN_Rep_Notes_Edit",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Repeated",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "المعرّف",
      "FIN_Once_ID",
      "معرّف المصروف",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "InDirExpense_Once_ID",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التفاصيل",
      "FIN_Once_Name",
      "اسم المصروف",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Expense_Name",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التفاصيل",
      "FIN_Once_Category",
      "التصنيف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Expense_Category",
      "FIN_InDirExpense_Once",
      "Category",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التواريخ",
      "FIN_Once_Date",
      "تاريخ المصروف",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Expense_Date",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "القيم",
      "FIN_Once_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "القيم",
      "FIN_Once_PaidBy",
      "مدفوع بواسطة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Paid_By",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الدفع",
      "FIN_Once_PayStatus",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Pending",
      "DD_Payment_Status",
      "FIN_InDirExpense_Once",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الدفع",
      "FIN_Once_PayMethod",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_InDirExpense_Once",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التوزيع",
      "FIN_Once_Allocation",
      "أساس التوزيع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Allocation_Method",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الإهلاك",
      "FIN_Once_UsefulLife",
      "العمر الإنتاجي (أشهر)",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Useful_Life_Months",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الإهلاك",
      "FIN_Once_DepStart",
      "تاريخ بدء الإهلاك",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Depreciation_Start_Date",
      "",
    ],
    [
      "FORM_FIN_AddIndirectExpenseOnce",
      "إضافة مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "ملاحظات",
      "FIN_Once_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "المعرّف",
      "FIN_Once_ID_View",
      "معرّف المصروف",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "InDirExpense_Once_ID",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التفاصيل",
      "FIN_Once_Name_Edit",
      "اسم المصروف",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Expense_Name",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التفاصيل",
      "FIN_Once_Category_Edit",
      "التصنيف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Expense_Category",
      "FIN_InDirExpense_Once",
      "Category",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التواريخ",
      "FIN_Once_Date_Edit",
      "تاريخ المصروف",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Expense_Date",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "القيم",
      "FIN_Once_Amount_Edit",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "القيم",
      "FIN_Once_PaidBy_Edit",
      "مدفوع بواسطة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Paid_By",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الدفع",
      "FIN_Once_PayStatus_Edit",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Status",
      "FIN_InDirExpense_Once",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الدفع",
      "FIN_Once_PayMethod_Edit",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_InDirExpense_Once",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "التوزيع",
      "FIN_Once_Allocation_Edit",
      "أساس التوزيع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Allocation_Method",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الإهلاك",
      "FIN_Once_UsefulLife_Edit",
      "العمر الإنتاجي (أشهر)",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Useful_Life_Months",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "الإهلاك",
      "FIN_Once_DepStart_Edit",
      "تاريخ بدء الإهلاك",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Depreciation_Start_Date",
      "",
    ],
    [
      "FORM_FIN_EditIndirectExpenseOnce",
      "تعديل مصروف غير مباشر (مرة واحدة)",
      "Sub_FIN_Indirect_Once",
      "المصاريف غير المباشرة (مرة واحدة)",
      "ملاحظات",
      "FIN_Once_Notes_Edit",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_InDirExpense_Once",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "المعرّف",
      "FIN_PrjRev_ID",
      "معرّف الإيراد",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Revenue_ID",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Project",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Projects",
      "FIN_Project_Revenue",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التواريخ",
      "FIN_PrjRev_Date",
      "تاريخ الإيراد",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Project_Revenue",
      "Revenue_Date",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "القيم",
      "FIN_PrjRev_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Project_Revenue",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Type",
      "نوع الإيراد",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Project",
      "DD_Revenue_Type",
      "FIN_Project_Revenue",
      "Revenue_Type",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Source",
      "المصدر",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Source",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Description",
      "الوصف",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Description",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "الدفع",
      "FIN_PrjRev_PayMethod",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_Project_Revenue",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "الدفع",
      "FIN_PrjRev_PayStatus",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Pending",
      "DD_Payment_Status",
      "FIN_Project_Revenue",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_AddProjectRevenue",
      "تسجيل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Invoice",
      "رقم الفاتورة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Invoice_Number",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "المعرّف",
      "FIN_PrjRev_ID_View",
      "معرّف الإيراد",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Revenue_ID",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Project_Edit",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Projects",
      "FIN_Project_Revenue",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التواريخ",
      "FIN_PrjRev_Date_Edit",
      "تاريخ الإيراد",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Project_Revenue",
      "Revenue_Date",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "القيم",
      "FIN_PrjRev_Amount_Edit",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Project_Revenue",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Type_Edit",
      "نوع الإيراد",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Revenue_Type",
      "FIN_Project_Revenue",
      "Revenue_Type",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Source_Edit",
      "المصدر",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Source",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Description_Edit",
      "الوصف",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Description",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "الدفع",
      "FIN_PrjRev_PayMethod_Edit",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_Project_Revenue",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "الدفع",
      "FIN_PrjRev_PayStatus_Edit",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Status",
      "FIN_Project_Revenue",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_EditProjectRevenue",
      "تعديل إيراد مشروع",
      "Sub_FIN_PrjRevenue",
      "إيرادات المشاريع",
      "التفاصيل",
      "FIN_PrjRev_Invoice_Edit",
      "رقم الفاتورة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Project_Revenue",
      "Invoice_Number",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "المعرّف",
      "FIN_Rev_ID",
      "معرّف الإيراد",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Revenue_ID",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Type",
      "نوع الإيراد",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "General",
      "DD_Revenue_Type",
      "FIN_Revenues",
      "Revenue_Type",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التواريخ",
      "FIN_Rev_Date",
      "تاريخ الإيراد",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Revenues",
      "Revenue_Date",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "القيم",
      "FIN_Rev_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Revenues",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Source",
      "المصدر",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Source",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Description",
      "الوصف",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Description",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "الدفع",
      "FIN_Rev_PayMethod",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_Revenues",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "الدفع",
      "FIN_Rev_PayStatus",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Pending",
      "DD_Payment_Status",
      "FIN_Revenues",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Client",
      "العميل",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Clients",
      "FIN_Revenues",
      "Client_ID",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Project",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Projects",
      "FIN_Revenues",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Reference",
      "المرجع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Reference",
      "",
    ],
    [
      "FORM_FIN_AddRevenue",
      "تسجيل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "ملاحظات",
      "FIN_Rev_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "المعرّف",
      "FIN_Rev_ID_View",
      "معرّف الإيراد",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Revenue_ID",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Type_Edit",
      "نوع الإيراد",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Revenue_Type",
      "FIN_Revenues",
      "Revenue_Type",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التواريخ",
      "FIN_Rev_Date_Edit",
      "تاريخ الإيراد",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Revenues",
      "Revenue_Date",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "القيم",
      "FIN_Rev_Amount_Edit",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Revenues",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Source_Edit",
      "المصدر",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Source",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Description_Edit",
      "الوصف",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Description",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "الدفع",
      "FIN_Rev_PayMethod_Edit",
      "طريقة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Method",
      "FIN_Revenues",
      "Pay_Method",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "الدفع",
      "FIN_Rev_PayStatus_Edit",
      "حالة الدفع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Payment_Status",
      "FIN_Revenues",
      "Pay_Status",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Client_Edit",
      "العميل",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Clients",
      "FIN_Revenues",
      "Client_ID",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Project_Edit",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Projects",
      "FIN_Revenues",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "التفاصيل",
      "FIN_Rev_Reference_Edit",
      "المرجع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Reference",
      "",
    ],
    [
      "FORM_FIN_EditRevenue",
      "تعديل إيراد عام",
      "Sub_FIN_GenRevenue",
      "الإيرادات العامة",
      "ملاحظات",
      "FIN_Rev_Notes_Edit",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Revenues",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "المعرّف",
      "FIN_Journal_ID",
      "معرّف القيد",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Journal",
      "Journal_ID",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التواريخ",
      "FIN_Journal_Date",
      "تاريخ القيد",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Journal",
      "Journal_Date",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "الحسابات",
      "FIN_Journal_Account",
      "الحساب",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Account",
      "FIN_Journal",
      "Account",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "الحسابات",
      "FIN_Journal_Counter",
      "الحساب المقابل",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Account",
      "FIN_Journal",
      "Counterparty_Account",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "القيم",
      "FIN_Journal_Debit",
      "المبلغ مدين",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Journal",
      "Debit_Amount",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "القيم",
      "FIN_Journal_Credit",
      "المبلغ دائن",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Journal",
      "Credit_Amount",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التفاصيل",
      "FIN_Journal_Project",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Projects",
      "FIN_Journal",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التفاصيل",
      "FIN_Journal_Description",
      "الوصف",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Journal",
      "Description",
      "",
    ],
    [
      "FORM_FIN_AddJournalEntry",
      "تسجيل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التفاصيل",
      "FIN_Journal_Reference",
      "المرجع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Journal",
      "Reference",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "المعرّف",
      "FIN_Journal_ID_View",
      "معرّف القيد",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Journal",
      "Journal_ID",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التواريخ",
      "FIN_Journal_Date_Edit",
      "تاريخ القيد",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Journal",
      "Journal_Date",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "الحسابات",
      "FIN_Journal_Account_Edit",
      "الحساب",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Account",
      "FIN_Journal",
      "Account",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "الحسابات",
      "FIN_Journal_Counter_Edit",
      "الحساب المقابل",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Account",
      "FIN_Journal",
      "Counterparty_Account",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "القيم",
      "FIN_Journal_Debit_Edit",
      "المبلغ مدين",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Journal",
      "Debit_Amount",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "القيم",
      "FIN_Journal_Credit_Edit",
      "المبلغ دائن",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Journal",
      "Credit_Amount",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التفاصيل",
      "FIN_Journal_Project_Edit",
      "المشروع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Projects",
      "FIN_Journal",
      "Project_ID",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التفاصيل",
      "FIN_Journal_Description_Edit",
      "الوصف",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Journal",
      "Description",
      "",
    ],
    [
      "FORM_FIN_EditJournalEntry",
      "تعديل قيد يومية",
      "Sub_FIN_Journal",
      "دفتر اليومية",
      "التفاصيل",
      "FIN_Journal_Reference_Edit",
      "المرجع",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Journal",
      "Reference",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "المعرّف",
      "FIN_Custody_ID",
      "معرّف العهدة",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Custody_ID",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "الموظف",
      "FIN_Custody_Employee",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "FIN_Custody",
      "Employee_ID",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "الموظف",
      "FIN_Custody_EmployeeName",
      "اسم الموظف",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Employee_Name",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "التواريخ",
      "FIN_Custody_IssueDate",
      "تاريخ التسليم",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Custody",
      "Issue_Date",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "التواريخ",
      "FIN_Custody_ReturnDue",
      "تاريخ الاستحقاق",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Return_Due_Date",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "القيم",
      "FIN_Custody_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Custody",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "التفاصيل",
      "FIN_Custody_Purpose",
      "الغرض",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Purpose",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "الحالة",
      "FIN_Custody_Status",
      "الحالة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Open",
      "DD_Custody_Status",
      "FIN_Custody",
      "Status",
      "",
    ],
    [
      "FORM_FIN_AddCustody",
      "تسجيل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "ملاحظات",
      "FIN_Custody_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Notes",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "المعرّف",
      "FIN_Custody_ID_View",
      "معرّف العهدة",
      "Display",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Custody_ID",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "الموظف",
      "FIN_Custody_Employee_Edit",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "FIN_Custody",
      "Employee_ID",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "الموظف",
      "FIN_Custody_EmployeeName_Edit",
      "اسم الموظف",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Employee_Name",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "التواريخ",
      "FIN_Custody_IssueDate_Edit",
      "تاريخ التسليم",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Custody",
      "Issue_Date",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "التواريخ",
      "FIN_Custody_ReturnDue_Edit",
      "تاريخ الاستحقاق",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Return_Due_Date",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "القيم",
      "FIN_Custody_Amount_Edit",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "FIN_Custody",
      "Amount",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "التفاصيل",
      "FIN_Custody_Purpose_Edit",
      "الغرض",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Purpose",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "الحالة",
      "FIN_Custody_Status_Edit",
      "الحالة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Custody_Status",
      "FIN_Custody",
      "Status",
      "",
    ],
    [
      "FORM_FIN_EditCustody",
      "تعديل عهدة",
      "Sub_FIN_Custody",
      "العهد",
      "ملاحظات",
      "FIN_Custody_Notes_Edit",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "FIN_Custody",
      "Notes",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التعريف",
      "HR_Emp_ID",
      "معرّف الموظف",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Employee_ID",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_FullNameEN",
      "الاسم (إنجليزي)",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Employees",
      "Full_Name_EN",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_FullNameAR",
      "الاسم (عربي)",
      "Text",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Employees",
      "Full_Name_AR",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_DOB",
      "تاريخ الميلاد",
      "Date",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Date_of_Birth",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_Gender",
      "النوع",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Gender",
      "HR_Employees",
      "Gender",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_NationalID",
      "الرقم القومي",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "National_ID",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_Marital",
      "الحالة الاجتماعية",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Marital_Status",
      "HR_Employees",
      "Marital_Status",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "البيانات الأساسية",
      "HR_Emp_Military",
      "الموقف من الخدمة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Military_Status",
      "HR_Employees",
      "Military_Status",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_MobileMain",
      "رقم الجوال الرئيسي",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Mobile_Main",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_MobileSub",
      "رقم جوال بديل",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Mobile_Sub",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_Email",
      "البريد الإلكتروني",
      "Email",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Email",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_Address",
      "العنوان",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Home_Address",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_EmergencyContact",
      "جهة الاتصال للطوارئ",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Emergency_Contact",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_Relation",
      "صلة القرابة",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Relation",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "التواصل",
      "HR_Emp_ECMobile",
      "رقم الطوارئ",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "EC_Mobile",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "العمل",
      "HR_Emp_JobTitle",
      "المسمى الوظيفي",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Job_Titles",
      "HR_Employees",
      "Job_Title",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "العمل",
      "HR_Emp_Department",
      "القسم",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Departments",
      "HR_Employees",
      "Department",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "العمل",
      "HR_Emp_HireDate",
      "تاريخ التعيين",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Employees",
      "Hire_Date",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "العمل",
      "HR_Emp_ContractType",
      "نوع التعاقد",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Contract_Types",
      "HR_Employees",
      "Contract_Type",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "الحالة والرواتب",
      "HR_Emp_Status",
      "حالة الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Active",
      "DD_Employee_Status",
      "HR_Employees",
      "Status",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "الحالة والرواتب",
      "HR_Emp_BasicSalary",
      "الراتب الأساسي",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Basic_Salary",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "الحالة والرواتب",
      "HR_Emp_Allowances",
      "البدلات",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Allowances",
      "",
    ],
    [
      "FORM_HR_AddEmployee",
      "إضافة موظف",
      "Sub_HR_Employees",
      "الموظفون",
      "الحالة والرواتب",
      "HR_Emp_Deductions",
      "الخصومات",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Employees",
      "Deductions",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التعريف",
      "HR_Att_ID",
      "معرّف الحضور",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Attendance_ID",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التعريف",
      "HR_Att_Employee",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "HR_Attendance",
      "Employee_ID",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التوقيت",
      "HR_Att_Date",
      "التاريخ",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Attendance",
      "Date",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التوقيت",
      "HR_Att_CheckIn",
      "وقت الحضور",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Check_In",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التوقيت",
      "HR_Att_CheckOut",
      "وقت الانصراف",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Check_Out",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_Hours",
      "ساعات العمل",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Hours",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_OTMinutes",
      "دقائق إضافية",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "OT_Minutes",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_OTAmount",
      "قيمة الإضافي",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "OT_Amount",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_Late",
      "دقائق التأخير",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Late_Minutes",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_Early",
      "مغادرة مبكرة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "EarlyLeave_Minutes",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_Overtime",
      "إجمالي الإضافي",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Overtime_Minutes",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "التقييم",
      "HR_Att_Status",
      "الحالة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "Present",
      "DD_Attendance_Status",
      "HR_Attendance",
      "Status",
      "",
    ],
    [
      "FORM_HR_AddAttendance",
      "تسجيل الحضور",
      "Sub_HR_Attendance",
      "الحضور",
      "الملاحظات",
      "HR_Att_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Attendance",
      "Notes",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "التعريف",
      "HR_LR_ID",
      "معرّف الطلب",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave_Requests",
      "Leave_ID",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "التعريف",
      "HR_LR_Employee",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "HR_Leave_Requests",
      "Employee_ID",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "الفترة",
      "HR_LR_Type",
      "نوع الإجازة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Leave_Types",
      "HR_Leave_Requests",
      "Leave_Type",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "الفترة",
      "HR_LR_Start",
      "تاريخ البداية",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Leave_Requests",
      "Start_Date",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "الفترة",
      "HR_LR_End",
      "تاريخ النهاية",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Leave_Requests",
      "End_Date",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "التفاصيل",
      "HR_LR_DaysCount",
      "عدد الأيام",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave_Requests",
      "Days_Count",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "التفاصيل",
      "HR_LR_Days",
      "أيام الإجازة",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave_Requests",
      "Days",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "التفاصيل",
      "HR_LR_Approver",
      "المعتمد",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Users",
      "HR_Leave_Requests",
      "Approver",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "التفاصيل",
      "HR_LR_Reason",
      "سبب الإجازة",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave_Requests",
      "Reason",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "الحالة",
      "HR_LR_Status",
      "حالة الطلب",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Pending",
      "DD_Leave_Status",
      "HR_Leave_Requests",
      "Status",
      "",
    ],
    [
      "FORM_HR_AddLeaveRequest",
      "تقديم طلب إجازة",
      "Sub_HR_Leave_Requests",
      "طلبات الإجازة",
      "الملاحظات",
      "HR_LR_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave_Requests",
      "Notes",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "التعريف",
      "HR_Leave_ID",
      "معرّف الإجازة",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave",
      "Leave_ID",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "التعريف",
      "HR_Leave_Emp",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "HR_Leave",
      "Emp_ID",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "الفترة",
      "HR_Leave_Type",
      "نوع الإجازة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Leave_Types",
      "HR_Leave",
      "Leave_Type",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "الفترة",
      "HR_Leave_Start",
      "تاريخ البداية",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Leave",
      "Start_Date",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "الفترة",
      "HR_Leave_End",
      "تاريخ النهاية",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Leave",
      "End_Date",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "التفاصيل",
      "HR_Leave_DaysCount",
      "عدد الأيام",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave",
      "Days_Count",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "الحالة",
      "HR_Leave_Status",
      "الحالة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Approved",
      "DD_Leave_Status",
      "HR_Leave",
      "Status",
      "",
    ],
    [
      "FORM_HR_AddLeave",
      "تسجيل إجازة",
      "Sub_HR_Leave",
      "سجلات الإجازة",
      "الملاحظات",
      "HR_Leave_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Leave",
      "Notes",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "التعريف",
      "HR_Adv_ID",
      "معرّف السلفة",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Advances",
      "Advance_ID",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "التعريف",
      "HR_Adv_Employee",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "HR_Advances",
      "Employee_ID",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "التفاصيل",
      "HR_Adv_IssueDate",
      "تاريخ الإصدار",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Advances",
      "Issue_Date",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "التفاصيل",
      "HR_Adv_Amount",
      "المبلغ",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Advances",
      "Amount",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "التفاصيل",
      "HR_Adv_Settlement",
      "فترة السداد",
      "Text",
      "",
      "",
      "No",
      "",
      "",
      "HR_Advances",
      "Settlement_Period",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "التفاصيل",
      "HR_Adv_Installment",
      "قسط السلفة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Advances",
      "Advance_Installment",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "الحالة",
      "HR_Adv_Status",
      "حالة السلفة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Pending",
      "DD_Advance_Status",
      "HR_Advances",
      "Status",
      "",
    ],
    [
      "FORM_HR_AddAdvance",
      "تسجيل سلفة",
      "Sub_HR_Advances",
      "السلف",
      "الملاحظات",
      "HR_Adv_Notes",
      "ملاحظات",
      "Paragraph",
      "",
      "",
      "No",
      "",
      "",
      "HR_Advances",
      "Notes",
      "",
    ],
    [
      "FORM_HR_AddDeduction",
      "تسجيل خصم",
      "Sub_HR_Deductions",
      "الخصومات",
      "التعريف",
      "HR_Ded_ID",
      "معرّف الخصم",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Deductions",
      "Deduction_ID",
      "",
    ],
    [
      "FORM_HR_AddDeduction",
      "تسجيل خصم",
      "Sub_HR_Deductions",
      "الخصومات",
      "التفاصيل",
      "HR_Ded_Penalty",
      "نوع المخالفة",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "No",
      "",
      "DD_Penalties",
      "HR_Deductions",
      "Penalty_ID",
      "",
    ],
    [
      "FORM_HR_AddDeduction",
      "تسجيل خصم",
      "Sub_HR_Deductions",
      "الخصومات",
      "التفاصيل",
      "HR_Ded_Employee",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "HR_Deductions",
      "Employee_ID",
      "",
    ],
    [
      "FORM_HR_AddDeduction",
      "تسجيل خصم",
      "Sub_HR_Deductions",
      "الخصومات",
      "التفاصيل",
      "HR_Ded_Date",
      "تاريخ الخصم",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Deductions",
      "Date",
      "",
    ],
    [
      "FORM_HR_AddDeduction",
      "تسجيل خصم",
      "Sub_HR_Deductions",
      "الخصومات",
      "التفاصيل",
      "HR_Ded_Amount",
      "قيمة الخصم",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Deductions",
      "Deduction_Amount",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "التعريف",
      "HR_Payroll_ID",
      "معرّف البيان",
      "Auto",
      "",
      "",
      "No",
      "",
      "",
      "HR_Payroll",
      "Payroll_ID",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "التعريف",
      "HR_Payroll_Employee",
      "الموظف",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "",
      "DD_Employees",
      "HR_Payroll",
      "Employee_ID",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "الفترة",
      "HR_Payroll_Start",
      "تاريخ البداية",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Payroll",
      "Start_Date",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "الفترة",
      "HR_Payroll_End",
      "تاريخ النهاية",
      "Date",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Payroll",
      "End_Date",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "القيم",
      "HR_Payroll_Basic",
      "الراتب الأساسي",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Payroll",
      "Basic_Salary",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "القيم",
      "HR_Payroll_OT",
      "إجمالي الإضافي",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Payroll",
      "Total_OT_Amount",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "القيم",
      "HR_Payroll_Advance",
      "قسط السلفة",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Payroll",
      "Advance_Installment",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "القيم",
      "HR_Payroll_Deductions",
      "الخصومات",
      "Number",
      "",
      "",
      "No",
      "",
      "",
      "HR_Payroll",
      "Deduction_Amount",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "القيم",
      "HR_Payroll_Net",
      "صافي الراتب",
      "Number",
      "",
      "",
      "Yes",
      "",
      "",
      "HR_Payroll",
      "Net_Pay",
      "",
    ],
    [
      "FORM_HR_AddPayroll",
      "إنشاء بيان راتب",
      "Sub_HR_Payroll",
      "الرواتب",
      "الحالة",
      "HR_Payroll_Status",
      "حالة البيان",
      "Dropdown",
      "SYS_Dropdowns",
      "",
      "Yes",
      "Draft",
      "DD_Payroll_Status",
      "HR_Payroll",
      "Status",
      "",
    ],
  ];
  return dynamicFormCache;
}

function seedSysDynamicForms(ss) {
  const sh = ss.getSheetByName("SYS_Dynamic_Forms");
  const rows = getDynamicFormDefinitions();
  appendRowsIfMissing(sh, rows, [0, 5]);
}

function seedSysDropdowns(ss) {
  const sh = ss.getSheetByName("SYS_Dropdowns");
  const rows = [
    ["DD_YesNo", "Yes", "نعم", "TRUE", 1],
    ["DD_YesNo", "No", "لا", "TRUE", 2],
    ["DD_Boolean", "True", "صحيح", "TRUE", 1],
    ["DD_Boolean", "False", "خطأ", "TRUE", 2],
    ["DD_User_Status", "Active", "نشط", "TRUE", 1],
    ["DD_User_Status", "Inactive", "غير نشط", "TRUE", 2],
    ["DD_MFA_Status", "Enabled", "مُفعّل", "TRUE", 1],
    ["DD_MFA_Status", "Disabled", "غير مُفعّل", "TRUE", 2],
    ["DD_Permission_Categories", "USERS", "المستخدمون", "TRUE", 1],
    ["DD_Permission_Categories", "SECURITY", "الأمان", "TRUE", 2],
    ["DD_Permission_Categories", "AUDIT", "التدقيق", "TRUE", 3],
    ["DD_Scopes", "GLOBAL", "عالمي", "TRUE", 1],
    ["DD_Scopes", "DEPARTMENT", "الإدارة", "TRUE", 2],
    ["DD_Scopes", "SELF", "ذاتي", "TRUE", 3],
    ["DD_Scopes", "LIMITED", "محدود", "TRUE", 4],
    ["DD_Attachment_Entities", "Users", "المستخدمون", "TRUE", 1],
    ["DD_Attachment_Entities", "Roles", "الأدوار", "TRUE", 2],
    ["DD_Attachment_Entities", "Permissions", "الأذونات", "TRUE", 3],
    [
      "DD_Attachment_Entities",
      "Role_Permissions",
      "أذونات_الأدوار",
      "TRUE",
      4,
    ],
    ["DD_Export_Formats", "CSV", "CSV", "TRUE", 1],
    ["DD_Export_Formats", "XLSX", "XLSX", "TRUE", 2],
    ["DD_Export_Formats", "JSON", "JSON", "TRUE", 3],
    ["DD_Payment_Status", "Pending", "قيد الانتظار", "TRUE", 1],
    ["DD_Payment_Status", "Approved", "مقبول", "TRUE", 2],
    ["DD_Payment_Status", "Rejected", "مرفوض", "TRUE", 3],
    ["DD_Payment_Status", "Paid", "مدفوع", "TRUE", 4],
    ["DD_Payment_Status", "Cancelled", "ملغى", "TRUE", 5],
    ["DD_Payment_Method", "Cash", "نقدي", "TRUE", 1],
    ["DD_Payment_Method", "Bank Transfer", "تحويل بنكي", "TRUE", 2],
    ["DD_Payment_Method", "Credit Card", "بطاقة ائتمان", "TRUE", 3],
    ["DD_Payment_Method", "Cheque", "شيك", "TRUE", 4],
    ["DD_Payment_Method", "Mobile Payment", "دفع عبر الجوال", "TRUE", 5],
    ["DD_Expense_Category", "Travel", "سفر", "TRUE", 1],
    ["DD_Expense_Category", "Utilities", "مرافق", "TRUE", 2],
    ["DD_Expense_Category", "Salaries", "رواتب", "TRUE", 3],
    ["DD_Expense_Category", "Office Supplies", "مستلزمات المكتب", "TRUE", 4],
    ["DD_Expense_Category", "Marketing", "تسويق", "TRUE", 5],
    ["DD_Expense_Category", "Maintenance", "صيانة", "TRUE", 6],
    ["DD_Expense_Category", "Rent", "إيجار", "TRUE", 7],
    ["DD_Expense_Category", "Other", "أخرى", "TRUE", 8],
    ["DD_Indirect_Frequency", "Monthly", "شهري", "TRUE", 1],
    ["DD_Indirect_Frequency", "Quarterly", "ربع سنوي", "TRUE", 2],
    ["DD_Indirect_Frequency", "Yearly", "سنوي", "TRUE", 3],
    ["DD_Indirect_Frequency", "One-time", "مرة واحدة", "TRUE", 4],
    ["DD_Revenue_Type", "Project", "مشروع", "TRUE", 1],
    ["DD_Revenue_Type", "General", "عام", "TRUE", 2],
    ["DD_Account", "Assets", "الأصول", "TRUE", 1],
    ["DD_Account", "Liabilities", "الخصوم", "TRUE", 2],
    ["DD_Account", "Equity", "حقوق الملكية", "TRUE", 3],
    ["DD_Account", "Revenue", "الإيرادات", "TRUE", 4],
    ["DD_Account", "Expenses", "المصروفات", "TRUE", 5],
    ["DD_Account", "Cash", "النقد", "TRUE", 6],
    ["DD_Account", "Bank", "البنك", "TRUE", 7],
    ["DD_Custody_Status", "Open", "مفتوحة", "TRUE", 1],
    ["DD_Custody_Status", "Closed", "مغلقة", "TRUE", 2],
    ["DD_Custody_Status", "Overdue", "متأخرة", "TRUE", 3],
    ["DD_Gender", "Male", "ذكر", "TRUE", 1],
    ["DD_Gender", "Female", "أنثى", "TRUE", 2],
    ["DD_Marital_Status", "Single", "أعزب", "TRUE", 1],
    ["DD_Marital_Status", "Married", "متزوج", "TRUE", 2],
    ["DD_Marital_Status", "Divorced", "مطلق", "TRUE", 3],
    ["DD_Marital_Status", "Widowed", "أرمل", "TRUE", 4],
    ["DD_Military_Status", "Completed", "أنهى الخدمة", "TRUE", 1],
    ["DD_Military_Status", "Exempted", "معفى", "TRUE", 2],
    ["DD_Military_Status", "In_Progress", "يؤدي الخدمة", "TRUE", 3],
    ["DD_Military_Status", "Not_Applicable", "غير مطلوب", "TRUE", 4],
    ["DD_Job_Titles", "HR Specialist", "أخصائي موارد بشرية", "TRUE", 1],
    ["DD_Job_Titles", "Accountant", "محاسب", "TRUE", 2],
    ["DD_Job_Titles", "Project Manager", "مدير مشروع", "TRUE", 3],
    ["DD_Job_Titles", "Site Engineer", "مهندس موقع", "TRUE", 4],
    ["DD_Job_Titles", "Procurement Officer", "مسؤول مشتريات", "TRUE", 5],
    ["DD_Job_Titles", "Administrator", "مسؤول إداري", "TRUE", 6],
    ["DD_Contract_Types", "Full_Time", "دوام كامل", "TRUE", 1],
    ["DD_Contract_Types", "Part_Time", "دوام جزئي", "TRUE", 2],
    ["DD_Contract_Types", "Contract", "عقد", "TRUE", 3],
    ["DD_Contract_Types", "Temporary", "مؤقت", "TRUE", 4],
    ["DD_Contract_Types", "Internship", "تدريب", "TRUE", 5],
    ["DD_Employee_Status", "Active", "نشط", "TRUE", 1],
    ["DD_Employee_Status", "Probation", "تحت التجربة", "TRUE", 2],
    ["DD_Employee_Status", "On_Leave", "في إجازة", "TRUE", 3],
    ["DD_Employee_Status", "Terminated", "منتهي الخدمة", "TRUE", 4],
    ["DD_Attendance_Status", "Present", "حاضر", "TRUE", 1],
    ["DD_Attendance_Status", "Absent", "غائب", "TRUE", 2],
    ["DD_Attendance_Status", "Late", "متأخر", "TRUE", 3],
    ["DD_Attendance_Status", "On_Leave", "في إجازة", "TRUE", 4],
    ["DD_Attendance_Status", "Remote", "عمل عن بُعد", "TRUE", 5],
    ["DD_Leave_Types", "Annual", "إجازة سنوية", "TRUE", 1],
    ["DD_Leave_Types", "Sick", "إجازة مرضية", "TRUE", 2],
    ["DD_Leave_Types", "Emergency", "إجازة طارئة", "TRUE", 3],
    ["DD_Leave_Types", "Unpaid", "إجازة بدون راتب", "TRUE", 4],
    ["DD_Leave_Types", "Maternity", "إجازة أمومة", "TRUE", 5],
    ["DD_Leave_Status", "Pending", "قيد المراجعة", "TRUE", 1],
    ["DD_Leave_Status", "Approved", "مقبولة", "TRUE", 2],
    ["DD_Leave_Status", "Rejected", "مرفوضة", "TRUE", 3],
    ["DD_Leave_Status", "Cancelled", "ملغاة", "TRUE", 4],
    ["DD_Advance_Status", "Pending", "قيد الاعتماد", "TRUE", 1],
    ["DD_Advance_Status", "Approved", "معتمدة", "TRUE", 2],
    ["DD_Advance_Status", "Disbursed", "مصروفة", "TRUE", 3],
    ["DD_Advance_Status", "Settled", "مقفلة", "TRUE", 4],
    ["DD_Payroll_Status", "Draft", "مسودة", "TRUE", 1],
    ["DD_Payroll_Status", "Submitted", "قيد المراجعة", "TRUE", 2],
    ["DD_Payroll_Status", "Approved", "معتمد", "TRUE", 3],
    ["DD_Payroll_Status", "Paid", "مدفوع", "TRUE", 4],
  ];

  const deptSheet = ss.getSheetByName("HR_Departments");
  if (deptSheet && deptSheet.getLastRow() > 1) {
    const deptData = deptSheet.getDataRange().getValues();
    const headers = deptData[0];
    const codeIdx = headers.indexOf("Dept_Code");
    const nameEnIdx = headers.indexOf("Dept_Name_EN");
    const nameArIdx = headers.indexOf("Dept_Name_AR");
    deptData.slice(1).forEach((row, index) => {
      const value =
        codeIdx >= 0 && row[codeIdx]
          ? row[codeIdx]
          : nameEnIdx >= 0
          ? row[nameEnIdx]
          : "";
      const labelAr = nameArIdx >= 0 ? row[nameArIdx] : "";
      const labelEn = nameEnIdx >= 0 ? row[nameEnIdx] : value;
      if (value) {
        rows.push([
          "DD_Departments",
          labelEn,
          labelAr || labelEn,
          "TRUE",
          10 + index,
        ]);
      }
    });
  }

  const rolesSheet = ss.getSheetByName("SYS_Roles");
  if (rolesSheet && rolesSheet.getLastRow() > 1) {
    const rolesData = rolesSheet.getDataRange().getValues();
    const headers = rolesData[0];
    const idIdx = headers.indexOf("Role_Id");
    const titleIdx = headers.indexOf("Role_Title");
    rolesData.slice(1).forEach((row, index) => {
      const roleId = idIdx >= 0 ? row[idIdx] : "";
      if (!roleId) return;
      const title = titleIdx >= 0 ? row[titleIdx] : roleId;
      rows.push([
        "DD_Roles",
        roleId,
        title,
        "TRUE",
        20 + index,
      ]);
    });
  }

  const employeesSheet = ss.getSheetByName("HR_Employees");
  if (employeesSheet && employeesSheet.getLastRow() > 1) {
    const employeeData = employeesSheet.getDataRange().getValues();
    const headers = employeeData[0];
    const idIdx = headers.indexOf("Employee_ID");
    const nameEnIdx = headers.indexOf("Full_Name_EN");
    const nameArIdx = headers.indexOf("Full_Name_AR");
    employeeData.slice(1).forEach((row, index) => {
      const empId = idIdx >= 0 ? row[idIdx] : "";
      if (!empId) return;
      const nameEn = nameEnIdx >= 0 ? row[nameEnIdx] : empId;
      const nameAr = nameArIdx >= 0 ? row[nameArIdx] : nameEn;
      rows.push([
        "DD_Employees",
        empId,
        nameAr || nameEn,
        "TRUE",
        30 + index,
      ]);
    });
  }

  const usersSheet = ss.getSheetByName("SYS_Users");
  if (usersSheet && usersSheet.getLastRow() > 1) {
    const userData = usersSheet.getDataRange().getValues();
    const headers = userData[0];
    const idIdx = headers.indexOf("User_Id");
    const nameIdx = headers.indexOf("Full_Name");
    userData.slice(1).forEach((row, index) => {
      const userId = idIdx >= 0 ? row[idIdx] : "";
      if (!userId) return;
      const label = nameIdx >= 0 ? row[nameIdx] : userId;
      rows.push([
        "DD_Users",
        userId,
        label || userId,
        "TRUE",
        40 + index,
      ]);
    });
  }

  const penaltiesSheet = ss.getSheetByName("HR_Penalties");
  if (penaltiesSheet && penaltiesSheet.getLastRow() > 1) {
    const penaltyData = penaltiesSheet.getDataRange().getValues();
    const headers = penaltyData[0];
    const idIdx = headers.indexOf("Penalty_ID");
    const nameIdx = headers.indexOf("Penalty_Name");
    penaltyData.slice(1).forEach((row, index) => {
      const penaltyId = idIdx >= 0 ? row[idIdx] : "";
      if (!penaltyId) return;
      const penaltyName = nameIdx >= 0 ? row[nameIdx] : penaltyId;
      rows.push([
        "DD_Penalties",
        penaltyId,
        penaltyName || penaltyId,
        "TRUE",
        50 + index,
      ]);
    });
  }

  appendRowsIfMissing(sh, rows, [0, 1]);
}

function seedHrDepartments(ss) {
  const sh = ss.getSheetByName("HR_Departments");
  const nowIso = ensureISODate(new Date());
  const rows = [
    ["MGMT", "Management", "الإدارة", "TRUE", 1, nowIso, SYSTEM_USER],
    ["HR", "Human Resources", "الموارد البشرية", "TRUE", 2, nowIso, SYSTEM_USER],
    ["FIN", "Finance", "المالية", "TRUE", 3, nowIso, SYSTEM_USER],
    ["PRJ", "Projects", "المشروعات", "TRUE", 4, nowIso, SYSTEM_USER],
  ];
  appendRowsIfEmpty(sh, rows);
}

function seedSysRoles(ss) {
  const sh = ss.getSheetByName("SYS_Roles");
  const nowIso = ensureISODate(new Date());
  const roles = [
    [
      "Admin",
      "Administrator",
      "Full system administrator",
      true,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "HR_Manager",
      "HR Manager",
      "Manages human resources data",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Manager",
      "Manager",
      "Department manager",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Basic_User",
      "Basic User",
      "General access",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_Project_Manager",
      "Project Manager",
      "Manage projects",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_Finance",
      "Finance",
      "Finance operations",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_Accountant",
      "Accountant",
      "Journal posting",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_Purchasing",
      "Purchasing",
      "Materials procurement",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_Sales",
      "Sales",
      "Clients & contracts",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_HR",
      "HR",
      "Human resources",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "ROLE_Payroll",
      "Payroll",
      "Payroll ops",
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
  ];
  appendRowsIfEmpty(sh, roles);
}

/** ---------- MAIN RUNNER ---------- **/
function setupERPAllSheets() {
  const ss = getTargetSpreadsheet();
  const schemas = getSheetSchemas();
  Object.keys(schemas).forEach((name) =>
    createOrClearSheet(ss, name, schemas[name])
  );
  seedCoreData();
  Logger.log("✅ Full ERP Setup Completed.");
}

/**
 * Audit and seed missing sheets and data in the target spreadsheet.
 * Scans the workbook for every sheet defined in getSheetSchemas() and creates it if missing.
 * Ensures the header row matches the schema definition.
 * After structural audit, calls seedCoreData() and other seeding helpers to populate
 * baseline data (SYS_Tab_Register, SYS_Dynamic_Forms, SYS_Dropdowns, etc.).
 * All create/seed operations are logged via logSetupAction for auditability.
 */
function logSetupAction(action, entity, targetSheet, details) {
  try {
    const ss = getTargetSpreadsheet();
    const logSheet = ss.getSheetByName('SYS_Audit_Log');
    const nowIso = new Date().toISOString();
    // [Timestamp, User, Action, Details, Entity, Entity_Id, Scope, Sheet, Target_Id, Actor_Id]
    logSheet.appendRow([
      nowIso,
      SYSTEM_USER,
      action,
      details,
      entity,
      '',
      'SYSTEM',
      targetSheet,
      '',
      SYSTEM_USER,
    ]);
  } catch (err) {
    Logger.log(`logSetupAction failed: ${err}`);
  }
}

function auditAndSeedERP() {
  const ss = getTargetSpreadsheet();
  const schemas = getSheetSchemas();
  const created = [];
  Object.keys(schemas).forEach(function (name) {
    let sheet = ss.getSheetByName(name);
    const headers = schemas[name];
    if (!sheet) {
      // Sheet missing: create and set headers
      sheet = ss.insertSheet(name);
      sheet
        .getRange(1, 1, 1, headers.length)
        .setValues([headers])
        .setFontWeight('bold')
        .setBackground('#E0E0E0');
      created.push(name);
      logSetupAction('CREATE_SHEET', name, name, 'Created missing sheet and set headers');
    } else {
      // Check header row; update if mismatched length or labels
      const existing = sheet.getRange(1, 1, 1, headers.length).getValues()[0];
      let mismatch = existing.length !== headers.length;
      if (!mismatch) {
        for (var i = 0; i < headers.length; i++) {
          if (existing[i] !== headers[i]) {
            mismatch = true;
            break;
          }
        }
      }
      if (mismatch) {
        sheet
          .getRange(1, 1, 1, headers.length)
          .setValues([headers])
          .setFontWeight('bold')
          .setBackground('#E0E0E0');
        logSetupAction('UPDATE_HEADERS', name, name, 'Updated header row to match schema');
      }
    }
  });
  // Seed missing data using existing seeder functions (idempotent)
  seedCoreData();
  Logger.log('✅ Audit and seeding complete. Created sheets: ' + created.join(', '));
  return created;
}
/** ---------- Seed Admin User ---------- **/
function seedAdminUser(ss) {
  const sh = ss.getSheetByName("SYS_Users");
  const now = new Date();
  const nowIso = ensureISODate(now);

  const username = "mkhoraiby";
  const password = "210388";
  const hashedPassword = Utilities.base64Encode(
    Utilities.computeDigest(Utilities.DigestAlgorithm.SHA_256, password)
  );

  const adminUser = [
    "USR_00001", // ID
    "Mohamed Sherif Elkhoraiby", // Full_Name
    username, // Username
    "m.elkhoraiby@gmail.com", // Email
    "System Administrator", // Job_Title
    "Management", // Department
    "Admin", // Role_Id
    true, // IsActive
    "",
    "", // Disabled_At, Disabled_By
    hashedPassword, // Password_Hash
    "", // Last_Login
    nowIso, // Created_At
    SYSTEM_USER, // Created_By
    nowIso, // Updated_At
    SYSTEM_USER, // Updated_By
    "", // External_Id
    false, // MFA_Enabled
    "System seeded admin account", // Notes
  ];

  appendRowsIfEmpty(sh, [adminUser]);
  Logger.log("✅ Admin user seeded successfully.");
}

function seedSysUsersView(ss) {
  const src = ss.getSheetByName("SYS_Users");
  const view = ss.getSheetByName("PV_SYS_Users_Table");
  if (!src || !view) return;
  const data = src.getDataRange().getValues();
  if (!data || data.length < 2) return;
  const headers = data[0];
  const idx = {
    id: headers.indexOf("User_Id"),
    fullName: headers.indexOf("Full_Name"),
    username: headers.indexOf("Username"),
    email: headers.indexOf("Email"),
    dept: headers.indexOf("Department"),
    role: headers.indexOf("Role_Id"),
    active: headers.indexOf("IsActive"),
    jobTitle: headers.indexOf("Job_Title"),
    lastLogin: headers.indexOf("Last_Login"),
    updatedAt: headers.indexOf("Updated_At"),
  };
  const rows = data.slice(1).map((row) => [
    row[idx.id] || "",
    row[idx.fullName] || "",
    row[idx.username] || "",
    row[idx.email] || "",
    row[idx.dept] || "",
    row[idx.role] || "",
    row[idx.active] || "",
    row[idx.jobTitle] || "",
    row[idx.lastLogin] || "",
    row[idx.updatedAt] || "",
  ]);
  if (!rows.length) return;
  appendRowsIfEmpty(view, rows);
  Logger.log("✅ PV_SYS_Users_Table seeded successfully.");
}
function seedViewFromSource(ss, sourceName, viewName, fieldOrder) {
  const workbook = ss || getTargetSpreadsheet();
  if (!workbook) return;

  const source = workbook.getSheetByName(sourceName);
  const view = workbook.getSheetByName(viewName);
  if (!source || !view) return;
  const data = source.getDataRange().getValues();
  if (!data || data.length < 2) return;
  const headers = data[0];
  let rows = data.slice(1);
  if (Array.isArray(fieldOrder) && fieldOrder.length) {
    const indexes = fieldOrder.map((field) => headers.indexOf(field));
    rows = rows.map((row) =>
      indexes.map((idx) => (idx >= 0 ? row[idx] : ""))
    );
  }
  appendRowsIfEmpty(view, rows);
  Logger.log("✅ " + viewName + " view synced from " + sourceName + ".");
}

function seedProjectViews(ss) {
  seedViewFromSource(ss, "PRJ_Main", "PV_PRJ_Main");
  seedViewFromSource(ss, "PRJ_Tasks", "PV_PRJ_Tasks");
  seedViewFromSource(ss, "PRJ_Costs", "PV_PRJ_Costs");
  seedViewFromSource(ss, "PRJ_Clients", "PV_PRJ_Clients");
  seedViewFromSource(ss, "PRJ_Schedule_Calc", "PV_PRJ_Schedule_Calc");
  seedViewFromSource(ss, "PRJ_Dashboard", "PV_PRJ_Dashboard");
  seedViewFromSource(ss, "PRJ_KPIs", "PV_PRJ_KPIs");
  seedViewFromSource(ss, "PRJ_InDirExp_Allocations", "PV_PRJ_InDirExp_Allocations");
  seedViewFromSource(ss, "FIN_Project_Revenue", "PV_FIN_Project_Revenue");
  seedViewFromSource(ss, "PRJ_Materials", "PV_PRJ_Materials");
}

function seedFinanceViews(ss) {
  seedViewFromSource(ss, "FIN_DirectExpenses", "PV_FIN_DirectExpenses_View", ["Expense_ID", "Project_ID", "Project_Name", "Date", "Category", "Material_ID", "Material_Name", "Qty", "Unit", "Unit_Price", "Amount", "VAT_Rate", "VAT_Amount", "Total_With_VAT", "Pay_Status", "Pay_Method", "Notes", "Created_By", "Created_At"]);
  seedViewFromSource(ss, "FIN_Revenues", "PV_FIN_Revenues");
  seedViewFromSource(ss, "FIN_Project_Revenue", "PV_FIN_Project_Revenue");
  seedViewFromSource(ss, "FIN_Journal", "PV_FIN_Journal");
  seedViewFromSource(ss, "FIN_Custody", "PV_FIN_Custody");
  seedViewFromSource(ss, "FIN_GL_Totals", "PV_FIN_GL_Totals");
  seedViewFromSource(ss, "FIN_KPIs", "PV_FIN_KPIs");
  seedViewFromSource(ss, "FIN_InDirExpense_Once", "PV_FIN_InDirExpense_Once");
  seedViewFromSource(ss, "FIN_InDirExpense_Repeated", "PV_FIN_InDirExpense_Repeated");
}

// Internal helper invoked by seedAllModules to refresh PV_HR_* sheets.
function seedHrViews(ss) {
  seedViewFromSource(ss, "HR_Employees", "PV_HR_Employees");
  seedViewFromSource(ss, "HR_Departments", "PV_HR_Departments");
  seedViewFromSource(ss, "HR_Attendance", "PV_HR_Attendance");
  seedViewFromSource(ss, "HR_Leave", "PV_HR_Leave");
  seedViewFromSource(ss, "HR_Leave_Requests", "PV_HR_Leave_Requests");
  seedViewFromSource(ss, "HR_Advances", "PV_HR_Advances");
  seedViewFromSource(ss, "HR_Deductions", "PV_HR_Deductions");
  seedViewFromSource(ss, "HR_Payroll", "PV_HR_Payroll");
}


function seedSysUserProperties(ss) {
  const sh = ss.getSheetByName("SYS_User_Properties");
  if (!sh) return;
  const nowIso = ensureISODate(new Date());
  const rows = [
    [
      "USR_00001",
      "Preferred_Language",
      "ar-EG",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "USR_00001",
      "Timezone",
      "Africa/Cairo",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
  ];
  appendRowsIfEmpty(sh, rows);
  Logger.log("✅ SYS_User_Properties seeded successfully.");
}

function seedSysDocuments(ss) {
  const sh = ss.getSheetByName("SYS_Documents");
  if (!sh) return;
  const nowIso = new Date().toISOString();
  const rows = [
    [
      "DOC_00001",
      "Users",
      "USR_00001",
      "Admin_Profile.pdf",
      "Resume",
      "drive-file-id-001",
      "https://drive.google.com/file/d/drive-file-id-001/view",
      "SYSTEM",
      nowIso,
    ],
  ];
  appendRowsIfEmpty(sh, rows);
  Logger.log("✅ SYS_Documents seeded successfully.");
}

function seedSysSessions(ss) {
  const sh = ss.getSheetByName("SYS_Sessions");
  if (!sh) return;
  const now = new Date();
  const nowIso = now.toISOString();
  const rows = [
    [
      "SESS-0001",
      "USR_00001",
      "m.elkhoraiby@gmail.com",
      "USR_00001",
      "LOGIN",
      "ACTIVE",
      "Chrome on Windows",
      "102.45.12.1",
      "",
      nowIso,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      "",
      "",
      JSON.stringify({ ipGeolocation: "Cairo, EG" }),
    ],
  ];
  appendRowsIfEmpty(sh, rows);
  Logger.log("✅ SYS_Sessions seeded successfully.");
}

function seedSysAuditLog(ss) {
  const sh = ss.getSheetByName("SYS_Audit_Log");
  if (!sh) return;
  const nowIso = new Date().toISOString();
  const rows = [
    [
      nowIso,
      "mkhoraiby",
      "LOGIN",
      "User authenticated via demo portal.",
      "User",
      "USR_00001",
      "SYSTEM",
      "SYS_Users",
      "USR_00001",
      "SYSTEM",
    ],
    [
      nowIso,
      "mkhoraiby",
      "VIEW",
      "Viewed system management dashboard.",
      "Dashboard",
      "SYSTEM_OVERVIEW",
      "SYSTEM",
      "Portal",
      "DASHBOARD",
      "SYSTEM",
    ],
  ];
  appendRowsIfEmpty(sh, rows);
  Logger.log("✅ SYS_Audit_Log seeded successfully.");
}

/** ---------- Seed System Permissions ---------- **/
function seedSysPermissions(ss) {
  const sh = ss.getSheetByName("SYS_Permissions");
  const nowIso = ensureISODate(new Date());

  const permissions = [
    [
      "SYS_VIEW_USERS",
      "View Users",
      "Allows viewing user list",
      "System",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "SYS_EDIT_USERS",
      "Edit Users",
      "Allows editing user info",
      "System",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "SYS_MANAGE_ROLES",
      "Manage Roles",
      "Allows managing roles and permissions",
      "System",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "SYS_VIEW_AUDIT",
      "View Audit Logs",
      "Allows viewing audit log records",
      "System",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "HR_VIEW_EMPLOYEES",
      "View Employees",
      "Allows viewing employee data",
      "HR",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "HR_EDIT_EMPLOYEES",
      "Edit Employees",
      "Allows modifying employee data",
      "HR",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "PRJ_VIEW_PROJECTS",
      "View Projects",
      "Allows viewing project data",
      "Projects",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "PRJ_EDIT_PROJECTS",
      "Edit Projects",
      "Allows editing project records",
      "Projects",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "FIN_VIEW_REPORTS",
      "View Finance Reports",
      "Allows viewing finance dashboards and reports",
      "Finance",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "FIN_EDIT_TRANSACTIONS",
      "Edit Transactions",
      "Allows recording and modifying transactions",
      "Finance",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
  ];

  appendRowsIfEmpty(sh, permissions);
  Logger.log("✅ SYS_Permissions seeded successfully.");
}
/** ---------- Seed Role Permissions ---------- **/
function seedSysRolePermissions(ss) {
  const sh = ss.getSheetByName("SYS_Role_Permissions");
  const nowIso = ensureISODate(new Date());

  const rolePermissions = [
    [
      "Admin",
      "SYS_VIEW_USERS",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "SYS_EDIT_USERS",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "SYS_MANAGE_ROLES",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "SYS_VIEW_AUDIT",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "HR_VIEW_EMPLOYEES",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "HR_EDIT_EMPLOYEES",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "PRJ_VIEW_PROJECTS",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "PRJ_EDIT_PROJECTS",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "FIN_VIEW_REPORTS",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      "Admin",
      "FIN_EDIT_TRANSACTIONS",
      "GLOBAL",
      true,
      "",
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
  ];

  appendRowsIfEmpty(sh, rolePermissions);
  Logger.log("✅ SYS_Role_Permissions seeded successfully.");
}
function seedCoreData() {
  const ss = getTargetSpreadsheet();
  seedSysSettings(ss);
  seedSysRoles(ss);
  seedSysDropdowns(ss);
  seedSysTabRegister(ss);
  seedSysProfileView(ss);
  seedSysDynamicForms(ss);
  seedSysPermissions(ss);
  seedSysRolePermissions(ss);
  seedAdminUser(ss);
  seedSysUsersView(ss);
  seedSysUserProperties(ss);
  seedSysDocuments(ss);
  seedSysSessions(ss);
  seedSysAuditLog(ss);
  seedAllModules(ss);
  Logger.log("✅ Core SYS + Admin seeding completed.");
}
/**
 * Main seeder function to populate the 'New Project' form definition
 * and all required dropdowns.
 * * This function is idempotent: it will clear old data before adding
 * new data to prevent duplicates.
 *
 * (FIXED: Now safely handles empty 'PRJ_Clients' and 'SYS_Users' sheets)
 */
function seedProjectFormAndDropdowns(ss) {
  const workbook = ss || getTargetSpreadsheet();
  
  // Get all required sheets
  const formsSheet = workbook.getSheetByName('SYS_Dynamic_Forms');
  const dropsSheet = workbook.getSheetByName('SYS_Dropdowns');
  const clientsSheet = workbook.getSheetByName('PRJ_Clients');
  const usersSheet = workbook.getSheetByName('SYS_Users');
  const projectsSheet = workbook.getSheetByName('PRJ_Main');

  // Safety check to ensure all sheets exist
  if (!formsSheet || !dropsSheet || !clientsSheet || !usersSheet) {
    let missing = [
      !formsSheet ? 'SYS_Dynamic_Forms' : null,
      !dropsSheet ? 'SYS_Dropdowns' : null,
      !clientsSheet ? 'PRJ_Clients' : null,
      !usersSheet ? 'SYS_Users' : null,
      !projectsSheet ? 'PRJ_Main' : null
    ].filter(Boolean).join(', ');
    
    Logger.log(`Error: Missing one or more required sheets: ${missing}.`);
    return;
  }

  Logger.log('All sheets found. Starting seeding process...');

  // --- 1. Clear existing data to prevent duplicates ---
  Logger.log('Clearing old data...');
  // Clear old form definition
  clearOldData(formsSheet, 'FORM_PRJ_AddProject', 0); // 0 is the column index for 'Form_ID'
  clearOldData(formsSheet, 'FORM_PRJ_AddTask', 0);
  clearOldData(formsSheet, 'FORM_PRJ_AddCost', 0);
  clearOldData(formsSheet, 'FORM_PRJ_AddRevenue', 0);
  clearOldData(formsSheet, 'FORM_PRJ_EditProject', 0);
  clearOldData(formsSheet, 'FORM_PRJ_ViewProject', 0);
  clearOldData(formsSheet, 'FORM_PRJ_EditTask', 0);
  clearOldData(formsSheet, 'FORM_PRJ_ViewTask', 0);
  
  // Clear old dropdowns
  clearOldData(dropsSheet, 'DD_Project_Status', 0); // 0 is the column index for 'Key'
  clearOldData(dropsSheet, 'DD_Clients', 0);
  clearOldData(dropsSheet, 'DD_Managers', 0);
  clearOldData(dropsSheet, 'DD_Projects', 0);
  clearOldData(dropsSheet, 'DD_Project_Assignees', 0);
  clearOldData(dropsSheet, 'DD_Project_Type', 0);
  clearOldData(dropsSheet, 'DD_Project_Priority', 0);
  clearOldData(dropsSheet, 'DD_Task_Priority', 0);
  clearOldData(dropsSheet, 'DD_Task_Status', 0);
  clearOldData(dropsSheet, 'DD_Cost_Categories', 0);

  // --- 2. Define New Form Data for 'FORM_PRJ_AddProject' ---
  // Based on the schema of 'SYS_Dynamic_Forms'
  const newFormData = [
    // [Form_ID, Form_Title, Tab_ID, Tab_Name, Section_Header, Field_ID, Field_Label, Field_Type, Source_Sheet, Source_Range, Mandatory, Default_Value, Dropdown_Key, Target_Sheet, Target_Column, Role_ID]
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Project_ID', 'معرّف المشروع', 'Auto', '', '', 'No', '', '', 'PRJ_Main', 'Project_ID', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Project_Name', 'اسم المشروع', 'Text', '', '', 'Yes', '', '', 'PRJ_Main', 'Project_Name', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Client_ID', 'العميل', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Clients', 'PRJ_Main', 'Client_ID', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Contract_ID', 'معرّف العقد', 'Text', '', '', 'No', '', '', 'PRJ_Main', 'Contract_ID', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Status', 'حالة المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', 'New', 'DD_Project_Status', 'PRJ_Main', 'Status', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'تصنيف المشروع', 'PRJ_Project_Type', 'نوع المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Project_Type', 'PRJ_Main', 'Project_Type', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'تصنيف المشروع', 'PRJ_Project_Priority', 'أولوية المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'No', 'Medium', 'DD_Project_Priority', 'PRJ_Main', 'Project_Priority', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Start_Date', 'تاريخ البدء', 'Date', '', '', 'Yes', '', '', 'PRJ_Main', 'Start_Date', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Planned_Days', 'الأيام المخططة', 'Number', '', '', 'No', '', '', 'PRJ_Main', 'Planned_Days', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Planned_End_Date', 'تاريخ الانتهاء المخطط', 'Date', '', '', 'No', '', '', 'PRJ_Main', 'Planned_End_Date', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'البيانات المالية', 'PRJ_Budget', 'الميزانية', 'Number', '', '', 'No', '', '', 'PRJ_Main', 'Budget', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'البيانات المالية', 'PRJ_Planned_Material_Expense', 'تكلفة المواد المخططة', 'Number', '', '', 'No', '', '', 'PRJ_Main', 'Planned_Material_Expense', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'الإدارة والملاحظات', 'PRJ_Manager', 'مدير المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Managers', 'PRJ_Main', 'Manager', ''],
    ['FORM_PRJ_AddProject', 'إضافة مشروع جديد', 'Sub_PRJ_Main', 'المشاريع', 'الإدارة والملاحظات', 'PRJ_Notes', 'ملاحظات', 'Paragraph', '', '', 'No', '', '', 'PRJ_Main', 'Notes', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_ID', 'معرّف المهمة', 'Auto', '', '', 'No', '', '', 'PRJ_Tasks', 'Task_ID', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_Project', 'المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Projects', 'PRJ_Tasks', 'Project_ID', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_Name', 'اسم المهمة', 'Text', '', '', 'Yes', '', '', 'PRJ_Tasks', 'Task_Name', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التعيينات', 'PRJ_Task_Assignee', 'المسؤول', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Project_Assignees', 'PRJ_Tasks', 'Assignee_ID', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'تصنيف المهمة', 'PRJ_Task_Priority', 'أولوية المهمة', 'Dropdown', 'SYS_Dropdowns', '', 'No', 'Medium', 'DD_Task_Priority', 'PRJ_Tasks', 'Task_Priority', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_PStart', 'تاريخ البدء المخطط', 'Date', '', '', 'No', '', '', 'PRJ_Tasks', 'Planned_Start', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_PEnd', 'تاريخ الانتهاء المخطط', 'Date', '', '', 'No', '', '', 'PRJ_Tasks', 'Planned_End', ''],
    ['FORM_PRJ_AddTask', 'إضافة مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'الحالة', 'PRJ_Task_Status', 'حالة المهمة', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', 'Not_Started', 'DD_Task_Status', 'PRJ_Tasks', 'Status', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Project_Name', 'اسم المشروع', 'Text', '', '', 'Yes', '', '', 'PRJ_Main', 'Project_Name', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Client_ID', 'العميل', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Clients', 'PRJ_Main', 'Client_ID', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Contract_ID', 'معرّف العقد', 'Text', '', '', 'No', '', '', 'PRJ_Main', 'Contract_ID', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'الحالة والتصنيف', 'PRJ_Status', 'حالة المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Project_Status', 'PRJ_Main', 'Status', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'الحالة والتصنيف', 'PRJ_Project_Type', 'نوع المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Project_Type', 'PRJ_Main', 'Project_Type', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'الحالة والتصنيف', 'PRJ_Project_Priority', 'أولوية المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Project_Priority', 'PRJ_Main', 'Project_Priority', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Start_Date', 'تاريخ البدء', 'Date', '', '', 'Yes', '', '', 'PRJ_Main', 'Start_Date', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Planned_Days', 'الأيام المخططة', 'Number', '', '', 'No', '', '', 'PRJ_Main', 'Planned_Days', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Planned_End_Date', 'تاريخ الانتهاء المخطط', 'Date', '', '', 'No', '', '', 'PRJ_Main', 'Planned_End_Date', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'البيانات المالية', 'PRJ_Budget', 'الميزانية', 'Number', '', '', 'No', '', '', 'PRJ_Main', 'Budget', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'البيانات المالية', 'PRJ_Planned_Material_Expense', 'تكلفة المواد المخططة', 'Number', '', '', 'No', '', '', 'PRJ_Main', 'Planned_Material_Expense', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'الإدارة والملاحظات', 'PRJ_Manager', 'مدير المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Managers', 'PRJ_Main', 'Manager', ''],
    ['FORM_PRJ_EditProject', 'تعديل مشروع', 'Sub_PRJ_Main', 'المشاريع', 'الإدارة والملاحظات', 'PRJ_Notes', 'ملاحظات', 'Paragraph', '', '', 'No', '', '', 'PRJ_Main', 'Notes', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Project_Name', 'اسم المشروع', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Project_Name', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Client_ID', 'العميل', 'Display', '', '', 'No', '', 'DD_Clients', 'PRJ_Main', 'Client_ID', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'بيانات المشروع الأساسية', 'PRJ_Contract_ID', 'معرّف العقد', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Contract_ID', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'الحالة والتصنيف', 'PRJ_Status', 'حالة المشروع', 'Display', '', '', 'No', '', 'DD_Project_Status', 'PRJ_Main', 'Status', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'الحالة والتصنيف', 'PRJ_Project_Type', 'نوع المشروع', 'Display', '', '', 'No', '', 'DD_Project_Type', 'PRJ_Main', 'Project_Type', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'الحالة والتصنيف', 'PRJ_Project_Priority', 'أولوية المشروع', 'Display', '', '', 'No', '', 'DD_Project_Priority', 'PRJ_Main', 'Project_Priority', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Start_Date', 'تاريخ البدء', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Start_Date', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Planned_Days', 'الأيام المخططة', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Planned_Days', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'التواريخ', 'PRJ_Planned_End_Date', 'تاريخ الانتهاء المخطط', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Planned_End_Date', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'البيانات المالية', 'PRJ_Budget', 'الميزانية', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Budget', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'البيانات المالية', 'PRJ_Planned_Material_Expense', 'تكلفة المواد المخططة', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Planned_Material_Expense', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'الإدارة والملاحظات', 'PRJ_Manager', 'مدير المشروع', 'Display', '', '', 'No', '', 'DD_Managers', 'PRJ_Main', 'Manager', ''],
    ['FORM_PRJ_ViewProject', 'عرض تفاصيل المشروع', 'Sub_PRJ_Main', 'المشاريع', 'الإدارة والملاحظات', 'PRJ_Notes', 'ملاحظات', 'Display', '', '', 'No', '', '', 'PRJ_Main', 'Notes', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_Name', 'اسم المهمة', 'Text', '', '', 'Yes', '', '', 'PRJ_Tasks', 'Task_Name', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_Project', 'المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Projects', 'PRJ_Tasks', 'Project_ID', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'تصنيف المهمة', 'PRJ_Task_Priority', 'أولوية المهمة', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Task_Priority', 'PRJ_Tasks', 'Task_Priority', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التعيينات', 'PRJ_Task_Assignee', 'المسؤول', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Project_Assignees', 'PRJ_Tasks', 'Assignee_ID', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_PStart', 'تاريخ البدء المخطط', 'Date', '', '', 'No', '', '', 'PRJ_Tasks', 'Planned_Start', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_PEnd', 'تاريخ الانتهاء المخطط', 'Date', '', '', 'No', '', '', 'PRJ_Tasks', 'Planned_End', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_AStart', 'تاريخ البدء الفعلي', 'Date', '', '', 'No', '', '', 'PRJ_Tasks', 'Actual_Start', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_AEnd', 'تاريخ الانتهاء الفعلي', 'Date', '', '', 'No', '', '', 'PRJ_Tasks', 'Actual_End', ''],
    ['FORM_PRJ_EditTask', 'تعديل مهمة مشروع', 'Sub_PRJ_Tasks', 'المهام', 'الحالة', 'PRJ_Task_Status', 'حالة المهمة', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Task_Status', 'PRJ_Tasks', 'Status', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_Name', 'اسم المهمة', 'Display', '', '', 'No', '', '', 'PRJ_Tasks', 'Task_Name', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'البيانات الأساسية', 'PRJ_Task_Project', 'المشروع', 'Display', '', '', 'No', '', 'DD_Projects', 'PRJ_Tasks', 'Project_ID', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'تصنيف المهمة', 'PRJ_Task_Priority', 'أولوية المهمة', 'Display', '', '', 'No', '', 'DD_Task_Priority', 'PRJ_Tasks', 'Task_Priority', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'التعيينات', 'PRJ_Task_Assignee', 'المسؤول', 'Display', '', '', 'No', '', 'DD_Project_Assignees', 'PRJ_Tasks', 'Assignee_ID', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_PStart', 'تاريخ البدء المخطط', 'Display', '', '', 'No', '', '', 'PRJ_Tasks', 'Planned_Start', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_PEnd', 'تاريخ الانتهاء المخطط', 'Display', '', '', 'No', '', '', 'PRJ_Tasks', 'Planned_End', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_AStart', 'تاريخ البدء الفعلي', 'Display', '', '', 'No', '', '', 'PRJ_Tasks', 'Actual_Start', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'التواريخ', 'PRJ_Task_AEnd', 'تاريخ الانتهاء الفعلي', 'Display', '', '', 'No', '', '', 'PRJ_Tasks', 'Actual_End', ''],
    ['FORM_PRJ_ViewTask', 'عرض تفاصيل المهمة', 'Sub_PRJ_Tasks', 'المهام', 'الحالة', 'PRJ_Task_Status', 'حالة المهمة', 'Display', '', '', 'No', '', 'DD_Task_Status', 'PRJ_Tasks', 'Status', ''],
    ['FORM_PRJ_AddCost', 'تسجيل تكلفة مشروع', 'Sub_PRJ_Costs', 'التكاليف', 'البيانات الأساسية', 'PRJ_Cost_ID', 'معرّف التكلفة', 'Auto', '', '', 'No', '', '', 'PRJ_Costs', 'Cost_ID', ''],
    ['FORM_PRJ_AddCost', 'تسجيل تكلفة مشروع', 'Sub_PRJ_Costs', 'التكاليف', 'البيانات الأساسية', 'PRJ_Cost_Project', 'المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Projects', 'PRJ_Costs', 'Project_ID', ''],
    ['FORM_PRJ_AddCost', 'تسجيل تكلفة مشروع', 'Sub_PRJ_Costs', 'التكاليف', 'البيانات الأساسية', 'PRJ_Cost_Date', 'تاريخ التكلفة', 'Date', '', '', 'Yes', '', '', 'PRJ_Costs', 'Date', ''],
    ['FORM_PRJ_AddCost', 'تسجيل تكلفة مشروع', 'Sub_PRJ_Costs', 'التكاليف', 'التصنيف', 'PRJ_Cost_Category', 'فئة التكلفة', 'Dropdown', 'SYS_Dropdowns', '', 'No', '', 'DD_Cost_Categories', 'PRJ_Costs', 'Category', ''],
    ['FORM_PRJ_AddCost', 'تسجيل تكلفة مشروع', 'Sub_PRJ_Costs', 'التكاليف', 'التفاصيل', 'PRJ_Cost_Desc', 'وصف التكلفة', 'Paragraph', '', '', 'No', '', '', 'PRJ_Costs', 'Description', ''],
    ['FORM_PRJ_AddCost', 'تسجيل تكلفة مشروع', 'Sub_PRJ_Costs', 'التكاليف', 'القيم', 'PRJ_Cost_Amount', 'المبلغ', 'Number', '', '', 'Yes', '', '', 'PRJ_Costs', 'Amount', ''],
    ['FORM_PRJ_AddRevenue', 'تسجيل إيراد مشروع', 'Sub_PRJ_Revenue', 'الإيرادات', 'البيانات الأساسية', 'PRJ_Revenue_ID', 'معرّف الإيراد', 'Auto', '', '', 'No', '', '', 'FIN_Project_Revenue', 'Revenue_ID', ''],
    ['FORM_PRJ_AddRevenue', 'تسجيل إيراد مشروع', 'Sub_PRJ_Revenue', 'الإيرادات', 'البيانات الأساسية', 'PRJ_Revenue_Project', 'المشروع', 'Dropdown', 'SYS_Dropdowns', '', 'Yes', '', 'DD_Projects', 'FIN_Project_Revenue', 'Project_ID', ''],
    ['FORM_PRJ_AddRevenue', 'تسجيل إيراد مشروع', 'Sub_PRJ_Revenue', 'الإيرادات', 'البيانات الأساسية', 'PRJ_Revenue_Date', 'تاريخ الإيراد', 'Date', '', '', 'Yes', '', '', 'FIN_Project_Revenue', 'Revenue_Date', ''],
    ['FORM_PRJ_AddRevenue', 'تسجيل إيراد مشروع', 'Sub_PRJ_Revenue', 'الإيرادات', 'القيم', 'PRJ_Revenue_Amount', 'المبلغ', 'Number', '', '', 'Yes', '', '', 'FIN_Project_Revenue', 'Amount', ''],
    ['FORM_PRJ_AddRevenue', 'تسجيل إيراد مشروع', 'Sub_PRJ_Revenue', 'الإيرادات', 'المصدر', 'PRJ_Revenue_Source', 'مصدر الإيراد', 'Text', '', '', 'No', '', '', 'FIN_Project_Revenue', 'Source', ''],
    ['FORM_PRJ_AddRevenue', 'تسجيل إيراد مشروع', 'Sub_PRJ_Revenue', 'الإيرادات', 'الحالة', 'PRJ_Revenue_Status', 'حالة الدفع', 'Dropdown', 'SYS_Dropdowns', '', 'No', 'Pending', 'DD_Payment_Status', 'FIN_Project_Revenue', 'Pay_Status', '']
  ];

  // --- 3. Define New Static Dropdown Data ---
  // Based on the schema of 'SYS_Dropdowns'
  const newStaticDropdowns = [
    // [Key, English_Title, Arabic_Title, Is_Active, Sort_Order]
    ['DD_Project_Status', 'New', 'جديد', 'TRUE', 1],
    ['DD_Project_Status', 'In_Progress', 'قيد التنفيذ', 'TRUE', 2],
    ['DD_Project_Status', 'Completed', 'مكتمل', 'TRUE', 3],
    ['DD_Project_Status', 'On_Hold', 'معلق', 'TRUE', 4],
    ['DD_Project_Status', 'Cancelled', 'ملغى', 'TRUE', 5],
    ['DD_Project_Type', 'Internal', 'مشروع داخلي', 'TRUE', 1],
    ['DD_Project_Type', 'Client_Project', 'مشروع عميل', 'TRUE', 2],
    ['DD_Project_Type', 'Maintenance', 'صيانة', 'TRUE', 3],
    ['DD_Project_Priority', 'High', 'عالية', 'TRUE', 1],
    ['DD_Project_Priority', 'Medium', 'متوسطة', 'TRUE', 2],
    ['DD_Project_Priority', 'Low', 'منخفضة', 'TRUE', 3],
    ['DD_Task_Priority', 'Critical', 'حرجة', 'TRUE', 1],
    ['DD_Task_Priority', 'High', 'مرتفعة', 'TRUE', 2],
    ['DD_Task_Priority', 'Medium', 'متوسطة', 'TRUE', 3],
    ['DD_Task_Priority', 'Low', 'منخفضة', 'TRUE', 4],
    ['DD_Task_Status', 'Not_Started', 'لم يبدأ', 'TRUE', 1],
    ['DD_Task_Status', 'In_Progress', 'قيد التنفيذ', 'TRUE', 2],
    ['DD_Task_Status', 'Completed', 'مكتملة', 'TRUE', 3],
    ['DD_Task_Status', 'Blocked', 'معلقة', 'TRUE', 4],
    ['DD_Cost_Categories', 'Labor', 'تكاليف العمالة', 'TRUE', 1],
    ['DD_Cost_Categories', 'Materials', 'مواد', 'TRUE', 2],
    ['DD_Cost_Categories', 'Equipment', 'معدات', 'TRUE', 3],
    ['DD_Cost_Categories', 'Misc', 'أخرى', 'TRUE', 4]
  ];

  // --- 4. Prepare Dynamic Client Dropdowns (from PRJ_Clients) ---
  // Assumes Client_ID is in Col A, Client_Name is in Col B
  let clientDropdowns = []; // Default to empty array
  const clientLastRow = clientsSheet.getLastRow();
  
  if (clientLastRow > 1) { // ***FIX***: Only run if there is data beyond the header
    const clientDataValues = clientsSheet.getRange(2, 1, clientLastRow - 1, 2).getValues();
    clientDropdowns = clientDataValues
      .filter(row => row[0] && row[1]) // Ensure Client_ID (row[0]) and Client_Name (row[1]) exist
      .map((row, index) => ['DD_Clients', row[0], row[1], 'TRUE', index + 1]); // [Key, English_Title(Value), Arabic_Title(Display), Active, Sort]
  }
  Logger.log(`Found ${clientDropdowns.length} clients to seed.`);


  // --- 5. Prepare Dynamic Manager & Assignee Dropdowns (from SYS_Users) ---
  // Assumes User_Id is in Col A, Full_Name is in Col B
  let managerDropdowns = [];
  let assigneeDropdowns = [];
  const usersLastRow = usersSheet.getLastRow();

  if (usersLastRow > 1) {
    const usersDataValues = usersSheet
      .getRange(2, 1, usersLastRow - 1, 2)
      .getValues();
    const filteredUsers = usersDataValues.filter((row) => row[0] && row[1]);
    managerDropdowns = filteredUsers.map((row, index) => [
      'DD_Managers',
      row[0],
      row[1],
      'TRUE',
      index + 1,
    ]);
    assigneeDropdowns = filteredUsers.map((row, index) => [
      'DD_Project_Assignees',
      row[0],
      row[1],
      'TRUE',
      index + 1,
    ]);
  }
  Logger.log(`Found ${managerDropdowns.length} managers to seed.`);
  Logger.log(`Found ${assigneeDropdowns.length} assignees to seed.`);

  // --- 6. Prepare Dynamic Projects Dropdowns (from PRJ_Main) ---
  let projectDropdowns = [];
  if (projectsSheet) {
    const projectsLastRow = projectsSheet.getLastRow();
    if (projectsLastRow > 1) {
      const projectValues = projectsSheet
        .getRange(2, 1, projectsLastRow - 1, 2)
        .getValues();
      projectDropdowns = projectValues
        .filter((row) => row[0])
        .map((row, index) => [
          'DD_Projects',
          row[0],
          row[1] || row[0],
          'TRUE',
          index + 1,
        ]);
    }
  }
  Logger.log(`Found ${projectDropdowns.length} projects to seed.`);

  // --- 7. Write all new data to the sheets ---
  Logger.log('Writing new data to sheets...');

  // Append form data
  if (newFormData.length > 0) {
    formsSheet.getRange(formsSheet.getLastRow() + 1, 1, newFormData.length, newFormData[0].length).setValues(newFormData);
    Logger.log(`Wrote ${newFormData.length} rows to SYS_Dynamic_Forms.`);
  }

  // Combine all new dropdowns and append
  const allNewDropdowns = newStaticDropdowns
    .concat(clientDropdowns)
    .concat(managerDropdowns)
    .concat(assigneeDropdowns)
    .concat(projectDropdowns);
  
  if (allNewDropdowns.length > 0) {
    dropsSheet.getRange(dropsSheet.getLastRow() + 1, 1, allNewDropdowns.length, allNewDropdowns[0].length).setValues(allNewDropdowns);
    Logger.log(`Wrote ${allNewDropdowns.length} rows to SYS_Dropdowns.`);
  }

  Logger.log('Seeding complete.');
  Logger.log('✅ Project forms and dropdowns seeded successfully.');
}

// Internal helper invoked by seedAllModules to refresh PV_PRJ_* sheets.
function seedProjectViewSheets(ss) {
  try {
    const workbook = ss || getTargetSpreadsheet();
    if (!workbook) {
      Logger.log('seedProjectViewSheets skipped: workbook unavailable.');
      return;
    }
    const pvMain = workbook.getSheetByName('PV_PRJ_Main');
    if (pvMain) {
      const maxRows = pvMain.getMaxRows();
      if (maxRows > 1) {
        pvMain.getRange(2, 1, maxRows - 1, pvMain.getMaxColumns()).clearContent();
      }
      const pvMainFormula = `=ARRAYFORMULA(
  LET(
    ids, PRJ_Main!A2:A,
    names, PRJ_Main!B2:B,
    clients, PRJ_Main!D2:D,
    startDates, PRJ_Main!F2:F,
    plannedDays, PRJ_Main!G2:G,
    plannedEnd, PRJ_Main!H2:H,
    actualEnd, PRJ_Main!I2:I,
    status, PRJ_Main!J2:J,
    types, PRJ_Main!K2:K,
    priority, PRJ_Main!L2:L,
    notes, PRJ_Main!M2:M,
    budget, PRJ_Main!O2:O,
    manager, PRJ_Main!V2:V,
    actualCost, IF(ids="",,IFERROR(SUMIF(PRJ_Costs!B:B, ids, PRJ_Costs!F:F), 0)),
    computedPlanEnd, IF(LEN(plannedEnd), plannedEnd, IF((startDates<>"")*(plannedDays<>""), startDates + plannedDays, "")),
    budgetDiff, IF((budget="")*(actualCost=0),"", IF(budget="", -actualCost, budget - actualCost)),
    progressRaw, IF((plannedDays>0)*(startDates<>""), (IF(actualEnd<>"", actualEnd, TODAY()) - startDates)/plannedDays, ""),
    progressPct, IF(progressRaw="", "", ROUND(100*MAX(0, MIN(progressRaw, 1)), 1)),
    output, {ids, names, clients, startDates, plannedDays, computedPlanEnd, actualEnd, status, types, priority, budget, actualCost, budgetDiff, progressPct, notes, manager}
  ,
    IF(ids="",,output)
  )
)`;
      pvMain.getRange(2, 1).setFormula(pvMainFormula);
      Logger.log('✅ PV_PRJ_Main formulas seeded.');
    }

    const pvCosts = workbook.getSheetByName('PV_PRJ_Costs');
    if (pvCosts) {
      const maxRows = pvCosts.getMaxRows();
      if (maxRows > 1) {
        pvCosts.getRange(2, 1, maxRows - 1, pvCosts.getMaxColumns()).clearContent();
      }
      const pvCostsFormula = `=ARRAYFORMULA(
  LET(
    projectIds, PRJ_Costs!B2:B,
    projectNames, IF(projectIds="", "", IFERROR(VLOOKUP(projectIds, PRJ_Main!A:B, 2, FALSE), "")),
    data, {projectIds, projectNames, PRJ_Costs!C2:C, PRJ_Costs!D2:D, PRJ_Costs!E2:E, PRJ_Costs!F2:F, PRJ_Costs!H2:H, PRJ_Costs!G2:G}
  ,
    IF(projectIds="",,data)
  )
)`;
      pvCosts.getRange(2, 1).setFormula(pvCostsFormula);
      Logger.log('✅ PV_PRJ_Costs query seeded.');
    }
  } catch (err) {
    Logger.log(`seedProjectViewSheets error: ${err}`);
  }
}

function collectDynamicFormRows(formIds) {
  const definitions = getDynamicFormDefinitions();
  const targetIds = new Set(formIds);
  return definitions.filter((row) => targetIds.has(row[0]));
}

const FINANCE_FORM_IDS = [
  'FORM_FIN_AddDirectExpense',
  'FORM_FIN_EditDirectExpense',
  'FORM_FIN_AddIndirectExpenseRep',
  'FORM_FIN_EditIndirectExpenseRep',
  'FORM_FIN_AddIndirectExpenseOnce',
  'FORM_FIN_EditIndirectExpenseOnce',
  'FORM_FIN_AddProjectRevenue',
  'FORM_FIN_EditProjectRevenue',
  'FORM_FIN_AddRevenue',
  'FORM_FIN_EditRevenue',
  'FORM_FIN_AddJournalEntry',
  'FORM_FIN_EditJournalEntry',
  'FORM_FIN_AddCustody',
  'FORM_FIN_EditCustody',
];

const FINANCE_DROPDOWN_KEYS = [
  'DD_Expense_Category',
  'DD_Payment_Status',
  'DD_Payment_Method',
  'DD_Indirect_Frequency',
  'DD_Revenue_Type',
  'DD_Account',
  'DD_Custody_Status',
];

function seedFinanceFormAndDropdowns(ss) {
  const workbook = ss || getTargetSpreadsheet();
  const formsSheet = workbook.getSheetByName('SYS_Dynamic_Forms');
  const dropdownSheet = workbook.getSheetByName('SYS_Dropdowns');

  if (!formsSheet || !dropdownSheet) {
    Logger.log('seedFinanceFormAndDropdowns skipped: required sheets missing.');
    return;
  }

  FINANCE_FORM_IDS.forEach((formId) => clearOldData(formsSheet, formId, 0));

  const financeRows = collectDynamicFormRows(FINANCE_FORM_IDS);
  if (financeRows.length) {
    formsSheet
      .getRange(formsSheet.getLastRow() + 1, 1, financeRows.length, financeRows[0].length)
      .setValues(financeRows);
  }

  FINANCE_DROPDOWN_KEYS.forEach((key) => clearOldData(dropdownSheet, key, 0));
  seedSysDropdowns(workbook);

  Logger.log('✅ Finance forms and dropdowns seeded successfully.');
}

const HR_FORM_IDS = [
  'FORM_HR_AddEmployee',
  'FORM_HR_AddAttendance',
  'FORM_HR_AddLeaveRequest',
  'FORM_HR_AddLeave',
  'FORM_HR_AddAdvance',
  'FORM_HR_AddDeduction',
  'FORM_HR_AddPayroll',
];

const HR_DROPDOWN_KEYS = [
  'DD_Departments',
  'DD_Job_Titles',
  'DD_Gender',
  'DD_Marital_Status',
  'DD_Military_Status',
  'DD_Employee_Status',
  'DD_Attendance_Status',
  'DD_Leave_Types',
  'DD_Leave_Status',
  'DD_Advance_Status',
  'DD_Payroll_Status',
  'DD_Penalties',
  'DD_Employees',
];

function seedHrFormAndDropdowns(ss) {
  const workbook = ss || getTargetSpreadsheet();
  const formsSheet = workbook.getSheetByName('SYS_Dynamic_Forms');
  const dropdownSheet = workbook.getSheetByName('SYS_Dropdowns');

  if (!formsSheet || !dropdownSheet) {
    Logger.log('seedHrFormAndDropdowns skipped: required sheets missing.');
    return;
  }

  HR_FORM_IDS.forEach((formId) => clearOldData(formsSheet, formId, 0));

  const hrRows = collectDynamicFormRows(HR_FORM_IDS);
  if (hrRows.length) {
    formsSheet
      .getRange(formsSheet.getLastRow() + 1, 1, hrRows.length, hrRows[0].length)
      .setValues(hrRows);
  }

  HR_DROPDOWN_KEYS.forEach((key) => clearOldData(dropdownSheet, key, 0));
  seedSysDropdowns(workbook);

  Logger.log('✅ HR forms and dropdowns seeded successfully.');
}

/**
 * High-level orchestrator for provisioning Projects, Finance, and HR modules.
 * Prefer calling this instead of invoking the individual seed helpers directly.
 */
function seedAllModules(ss) {
  const workbook = ss || getTargetSpreadsheet();

  seedProjectFormAndDropdowns(workbook);
  seedProjectViewSheets(workbook);
  seedProjectViews(workbook);

  seedFinanceFormAndDropdowns(workbook);
  seedFinanceViewSheets(workbook);
  seedFinanceViews(workbook);

  seedHrDepartments(workbook);
  seedHrFormAndDropdowns(workbook);
  seedHrViewSheets(workbook);
  seedHrViews(workbook);

  Logger.log('✅ All modules seeded successfully.');
}

// Internal helper invoked by seedAllModules to refresh PV_FIN_* sheets.
function seedFinanceViewSheets(ss) {
  try {
    const workbook = ss || getTargetSpreadsheet();
    if (!workbook) {
      Logger.log('seedFinanceViewSheets skipped: workbook unavailable.');
      return;
    }

    const financeViewConfigs = [
      {
        sheetName: 'PV_FIN_DirectExpenses_View',
        dependencies: ['FIN_DirectExpenses', 'PRJ_Main'],
        formula: `=QUERY({
  FIN_DirectExpenses!A2:A,
  FIN_DirectExpenses!C2:C,
  FIN_DirectExpenses!B2:B,
  IFERROR(VLOOKUP(FIN_DirectExpenses!B2:B, PRJ_Main!A:B, 2, FALSE), ""),
  FIN_DirectExpenses!D2:D,
  FIN_DirectExpenses!E2:E,
  FIN_DirectExpenses!F2:F,
  FIN_DirectExpenses!N2:N,
  FIN_DirectExpenses!O2:O,
  FIN_DirectExpenses!H2:H,
  FIN_DirectExpenses!G2:G,
  FIN_DirectExpenses!I2:I,
  FIN_DirectExpenses!J2:J,
  FIN_DirectExpenses!K2:K,
  FIN_DirectExpenses!L2:L,
  FIN_DirectExpenses!M2:M,
  FIN_DirectExpenses!P2:P,
  FIN_DirectExpenses!Q2:Q,
  FIN_DirectExpenses!R2:R,
  FIN_DirectExpenses!T2:T,
  FIN_DirectExpenses!S2:S,
  FIN_DirectExpenses!V2:V,
  FIN_DirectExpenses!U2:U
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12,Col13,Col14,Col15,Col16,Col17,Col18,Col19,Col20,Col21,Col22,Col23 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 '', Col13 '', Col14 '', Col15 '', Col16 '', Col17 '', Col18 '', Col19 '', Col20 '', Col21 '', Col22 '', Col23 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_InDirExpense_Repeated_View',
        dependencies: ['FIN_InDirExpense_Repeated'],
        formula: `=QUERY({
  FIN_InDirExpense_Repeated!A2:A,
  FIN_InDirExpense_Repeated!B2:B,
  FIN_InDirExpense_Repeated!C2:C,
  FIN_InDirExpense_Repeated!D2:D,
  FIN_InDirExpense_Repeated!E2:E,
  FIN_InDirExpense_Repeated!F2:F,
  FIN_InDirExpense_Repeated!G2:G,
  FIN_InDirExpense_Repeated!H2:H,
  FIN_InDirExpense_Repeated!I2:I,
  FIN_InDirExpense_Repeated!J2:J,
  FIN_InDirExpense_Repeated!K2:K,
  FIN_InDirExpense_Repeated!L2:L,
  FIN_InDirExpense_Repeated!M2:M,
  FIN_InDirExpense_Repeated!N2:N,
  FIN_InDirExpense_Repeated!P2:P
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12,Col13,Col14,Col15 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 '', Col13 '', Col14 '', Col15 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_InDirExpense_Once_View',
        dependencies: ['FIN_InDirExpense_Once'],
        formula: `=QUERY({
  FIN_InDirExpense_Once!A2:A,
  FIN_InDirExpense_Once!B2:B,
  FIN_InDirExpense_Once!C2:C,
  FIN_InDirExpense_Once!D2:D,
  FIN_InDirExpense_Once!E2:E,
  FIN_InDirExpense_Once!F2:F,
  FIN_InDirExpense_Once!G2:G,
  FIN_InDirExpense_Once!H2:H,
  FIN_InDirExpense_Once!I2:I,
  FIN_InDirExpense_Once!J2:J,
  FIN_InDirExpense_Once!K2:K,
  FIN_InDirExpense_Once!L2:L,
  FIN_InDirExpense_Once!M2:M,
  FIN_InDirExpense_Once!O2:O
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12,Col13,Col14 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 '', Col13 '', Col14 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_Project_Revenue_View',
        dependencies: ['FIN_Project_Revenue', 'PRJ_Main'],
        formula: `=QUERY({
  FIN_Project_Revenue!A2:A,
  FIN_Project_Revenue!B2:B,
  FIN_Project_Revenue!C2:C,
  FIN_Project_Revenue!D2:D,
  FIN_Project_Revenue!E2:E,
  FIN_Project_Revenue!F2:F,
  FIN_Project_Revenue!G2:G,
  FIN_Project_Revenue!H2:H,
  FIN_Project_Revenue!I2:I,
  FIN_Project_Revenue!J2:J,
  FIN_Project_Revenue!L2:L,
  FIN_Project_Revenue!K2:K,
  FIN_Project_Revenue!M2:M
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12,Col13,Col14 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 '', Col13 '', Col14 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_Revenues_View',
        dependencies: ['FIN_Revenues', 'PRJ_Clients', 'PRJ_Main'],
        formula: `=QUERY({
  FIN_Revenues!A2:A,
  FIN_Revenues!C2:C,
  FIN_Revenues!B2:B,
  FIN_Revenues!D2:D,
  FIN_Revenues!E2:E,
  FIN_Revenues!F2:F,
  FIN_Revenues!G2:G,
  FIN_Revenues!H2:H,
  FIN_Revenues!I2:I,
  IFERROR(VLOOKUP(FIN_Revenues!I2:I, PRJ_Clients!A:B, 2, FALSE), ""),
  FIN_Revenues!J2:J,
  IFERROR(VLOOKUP(FIN_Revenues!J2:J, PRJ_Main!A:B, 2, FALSE), ""),
  FIN_Revenues!K2:K,
  FIN_Revenues!L2:L,
  FIN_Revenues!N2:N,
  FIN_Revenues!M2:M,
  FIN_Revenues!O2:O
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12,Col13,Col14,Col15,Col16,Col17 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 '', Col13 '', Col14 '', Col15 '', Col16 '', Col17 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_Journal_View',
        dependencies: ['FIN_Journal'],
        formula: `=QUERY({
  FIN_Journal!A2:A,
  FIN_Journal!B2:B,
  FIN_Journal!C2:C,
  FIN_Journal!D2:D,
  FIN_Journal!E2:E,
  FIN_Journal!F2:F,
  FIN_Journal!G2:G,
  FIN_Journal!H2:H,
  FIN_Journal!I2:I,
  FIN_Journal!K2:K,
  FIN_Journal!J2:J,
  FIN_Journal!L2:L
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_Custody_View',
        dependencies: ['FIN_Custody'],
        formula: `=QUERY({
  FIN_Custody!A2:A,
  FIN_Custody!B2:B,
  FIN_Custody!C2:C,
  FIN_Custody!D2:D,
  FIN_Custody!E2:E,
  FIN_Custody!F2:F,
  FIN_Custody!G2:G,
  FIN_Custody!H2:H,
  FIN_Custody!I2:I,
  FIN_Custody!K2:K,
  FIN_Custody!J2:J,
  FIN_Custody!L2:L
},
"select Col1,Col2,Col3,Col4,Col5,Col6,Col7,Col8,Col9,Col10,Col11,Col12 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 '', Col6 '', Col7 '', Col8 '', Col9 '', Col10 '', Col11 '', Col12 ''",
0)`
      },
      {
        sheetName: 'PV_FIN_GL_Totals_View',
        dependencies: ['FIN_GL_Totals'],
        formula: `=QUERY(FIN_GL_Totals!A2:E,
"select Col1,Col2,Col3,Col4,Col5 where Col1 is not null label Col1 '', Col2 '', Col3 '', Col4 '', Col5 ''",
0)`
      },
    ];

    financeViewConfigs.forEach(({ sheetName, dependencies, formula }) => {
      const sheet = workbook.getSheetByName(sheetName);
      if (!sheet) return;
      if (!ensureSheetsAvailable(workbook, dependencies, sheetName)) return;
      applyFormulaToViewSheet(sheet, formula);
      Logger.log(`✅ ${sheetName} query seeded.`);
    });
  } catch (err) {
    Logger.log(`seedFinanceViewSheets error: ${err}`);
  }
}


function seedHrViewSheets(ss) {
  try {
    const workbook = ss || getTargetSpreadsheet();
    if (!workbook) {
      Logger.log('seedHrViewSheets skipped: workbook unavailable.');
      return;
    }

    const hrViewConfigs = [
      { sheetName: 'PV_HR_Employees', source: 'HR_Employees' },
      { sheetName: 'PV_HR_Departments', source: 'HR_Departments' },
      { sheetName: 'PV_HR_Attendance', source: 'HR_Attendance' },
      { sheetName: 'PV_HR_Leave', source: 'HR_Leave' },
      { sheetName: 'PV_HR_Leave_Requests', source: 'HR_Leave_Requests' },
      { sheetName: 'PV_HR_Advances', source: 'HR_Advances' },
      { sheetName: 'PV_HR_Deductions', source: 'HR_Deductions' },
      { sheetName: 'PV_HR_Payroll', source: 'HR_Payroll' },
    ];

    hrViewConfigs.forEach(({ sheetName, source }) => {
      const sheet = workbook.getSheetByName(sheetName);
      if (!sheet) return;
      if (!ensureSheetsAvailable(workbook, [source], sheetName)) return;

      const sourceSheet = workbook.getSheetByName(source);
      if (!sourceSheet) return;
      const lastColumnLetter = columnToLetter(sourceSheet.getLastColumn());
      const formula = `=ARRAYFORMULA(IF(LEN(${source}!A2:A)=0,"",${source}!A2:${lastColumnLetter}))`;
      applyFormulaToViewSheet(sheet, formula);
      Logger.log(`✅ ${sheetName} mirror seeded.`);
    });
  } catch (err) {
    Logger.log(`seedHrViewSheets error: ${err}`);
  }
}





/**
 * Helper function to clear existing data from a sheet based on a key 
 * in a specific column, preserving the header row.
 * @param {GoogleAppsScript.Spreadsheet.Sheet} sheet The sheet to clear data from.
 * @param {string} key The key to look for (e.g., 'FORM_PRJ_AddProject').
 * @param {number} colIndex The 0-based index of the column to check for the key.
 */
function clearOldData(sheet, key, colIndex) {
  // Get all data, including headers
  const data = sheet.getDataRange().getValues();
  
  // If sheet is empty or only has a header, do nothing
  if (data.length <= 1) {
    // Handle edge case where sheet has 1 empty row [[""]]
    if (data.length == 1 && data[0].length == 1 && data[0][0] == "") {
      // This is a truly empty sheet, do nothing.
      return;
    }
    // Otherwise, it's just a header, so also do nothing.
    return;
  }

  // Keep the header row
  const header = data.shift();
  
  // Filter the data, keeping only rows that DO NOT match the key
  const newData = data.filter(row => row[colIndex] !== key);

  // Add the header back to the top
  newData.unshift(header);

  // Clear the entire sheet's content
  sheet.clearContents(); // Preserves formatting
  
  // Write the filtered data (header + non-matching rows) back to the sheet
  // ***FIX***: Added check for newData[0] to prevent error on empty header
  if (newData.length > 0 && newData[0] && newData[0].length > 0) {
     sheet.getRange(1, 1, newData.length, newData[0].length).setValues(newData);
  }
}
